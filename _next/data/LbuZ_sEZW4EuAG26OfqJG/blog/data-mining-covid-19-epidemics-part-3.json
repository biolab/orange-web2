{"pageProps":{"frontmatter":{"author":"Andreja Kovačič","date":"2020-04-20","draft":false,"title":"Data Mining COVID-19 Epidemics: Part 3","thumbImage":"2020-04-15-thumb-log-growth.png","frontPageImage":"2020-04-15-thumb-log-growth.png","blog":["covid-19","visualization","addons","trends","time"],"shortExcerpt":"Inspection of Covid-19 time trends.","longExcerpt":"Inspecting and comparing Covid-19 time trends, absolute and relative growth.","x2images":false,"aliases":["/blog/2020/2020-4-015-covid-19-part-3/"]},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    h2: \"h2\",\n    em: \"em\",\n    h3: \"h3\",\n    pre: \"pre\",\n    code: \"code\",\n    hr: \"hr\"\n  }, _provideComponents(), props.components), {WorkflowScreenshot, WindowScreenshot, Figure} = _components;\n  if (!Figure) _missingMdxReference(\"Figure\", true);\n  if (!WindowScreenshot) _missingMdxReference(\"WindowScreenshot\", true);\n  if (!WorkflowScreenshot) _missingMdxReference(\"WorkflowScreenshot\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"So far, we've seen how to make \", _jsx(_components.a, {\n        href: \"https://orange.biolab.si/blog/2020/2020-04-02-covid-19-basic/\",\n        children: \"basic visualizations\"\n      }), \" related to the corona virus and how to look at the \", _jsx(_components.a, {\n        href: \"https://orange.biolab.si/blog/2020/2020-04-09-covid-19-part-2/\",\n        children: \"disease progression on the map\"\n      }), \". Be sure to check them out first, before delving into this one.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We are now heading towards somewhat more advanced visualizations that let us observe trends in the data. Just as a heads up: your results may be different, depending on the day you downloaded the data. We are working with confirmed cases up to April 13, on the previously mentioned data from the John Hopkins University.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Prerequisite: Timeseries add-on\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The spread of the virus is influenced by many factors, time being one of them. Timeseries add-on specializes in manipulation of time-related data. If you followed our blogs, you should already have it installed. If you don't, just take a peek in the \", _jsx(_components.a, {\n        href: \"https://orange.biolab.si/blog/2020/2020-04-09-covid-19-part-2/\",\n        children: \"second one\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Formatting the data As Timeseries\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We'll load our data as usual with the File widget. The data contains latitude and longitude columns, which are just getting in the way in our further analysis. We will use Select Columns to put them into meta columns and thus exclude them from any calculations. Then we'll select some countries we are interested in with the help of the Data Table. You could also do it straight after inspecting the data in Geo Map.\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-wf1.png\",\n      width: \"314\",\n      height: \"224\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-wf1.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now we just need to tell Orange, which variable contains time stamps. Our dates are represented as columns instead of as rows, so we'll use Transpose widget to make each row represent a datum and then connect it to As Timeseries Widget. In Transpose, we set the variable whose values will be used to name the rows when they are turned into columns. We'll name them by the column Country, as shown in the image, since the Province field is mostly empty. In As Timeseries, we set \", _jsx(_components.em, {\n        children: \"sequence as implied by instance order\"\n      }), \".\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-as_timeseries.png\",\n      width: \"344\",\n      height: \"270\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-as_timeseries.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here is our chain of widgets. We should now be ready to start making some plots. Phew.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-first-snake.png\",\n      width: \"763\",\n      height: \"190\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-first-snake.webp\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Line Chart and log plot\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Make sure you've selected countries you are interested in the Data Table. I've chosen Italy, US, Iran, France and Chinese province Hubei. Then, connect As Timeseries widget and Line Chart and let's get plotting. Once in Line Chart, we can select multiple countries by clicking Ctrl/Cmd and draw them on the same axis or we could compare multiple plots by clicking on Add plot.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-line-chart1.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-line-chart1.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here, we see how the virus started its path in China, where the number of cases quickly rose but has since then stayed level. Other countries were hit later on. The slopes of the curves tell us how fast the numbers are growing, but more on that later. One thing to notice though: due to the fast growth of the virus in some countries, some smaller slopes are almost invisible. We can remedy that by checking the Logarithmic axis box just like this:\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-log-linechart.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-log-linechart.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can now see the first steps as well as the current situation.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Python Script\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can see from these plots, that different countries came into contact with the virus at different times. It seems it would be much easier to compare the curves if all of them started their climb at the same time. We can do that with just a few lines of code. Example snippet here aligns the curves with the moment where the country recorded 100 cases. You can set n to any other (positive) number if you will, though.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"import numpy as np\\nfrom copy import deepcopy\\n\\nn = 100\\nout_data = deepcopy(in_data)\\nout_data.X[out_data.X < n] = 0\\nar = np.argwhere(out_data.X)\\n\\ncols, shifts = np.unique(ar[:, 1], return_counts=True)\\nout_data.X = np.array([np.roll(out_data.X[:, col], shift) for col, shift in zip(cols, shifts)]).T\\nout_data.X[out_data.X==0]= np.nan\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Copy these lines into Python Script widget, and plug it into our initial snake of widgets like so:\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-snake-pyscript.png\",\n      width: \"897\",\n      height: \"193\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-snake-pyscript.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Look at the aligned curves now, they are much easier to compare.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-script-log-lc.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-script-log-lc.webp\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Absolute growth with derivative\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's take a look at how fast the confirmed cases are spreading. Connect As Timeseries with Difference widget, choose Differencing and select countries of interest. Differencing order of 1 means we'll be looking at derivative of first order, which just means daily change in our case. We'll leave shift as is, on 1.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-diff-settings.png\",\n      width: \"346\",\n      height: \"570\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-diff-settings.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Again, we'll view the transformed curves in Line Chart. Notice how the difference (and every other) transform adds a new column? That means we can compare our curves in different states, so be sure to always check what is being shown. For starters, try looking at, for example, China and its transformed version. See how easy it is to spot the daily spikes that are perhaps out of the ordinary and need to be checked? The most prominent spike here is probably due to the change in counting.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-china-dif.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-china-dif.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If we again compare multiple countries, we notice the US's speedy climb and Iran seemingly being more successful in curbing the growth.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-diff-compare.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-diff-compare.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The difference could be only due to the difference in population and what is an overwhelmingly large number of patients for one country might be almost business as usual for another one.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Scale free growth with quotient\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Difference widget also has the option to output the quotients. It will allow us to observe the relative growth and compare countries directly.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-quot-settings.png\",\n      width: \"346\",\n      height: \"570\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-quot-settings.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's look at, for example, China (Hubei province) vs France.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-china-fr-quot.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-china-fr-quot.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It seems China is doing worse in the beginning and better later on, but it is impossible to tell at which point the trends start to shift. There are just too many jumps, due to noise in testing and reporting. So for our final step, let's smooth things out.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Moving transform and smoothing\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Smoothing is usually a part of preprocessing, so insert the Moving Transform widget between As Timeseries and Difference, and add some moving average transforms, like this:\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-wf3.png\",\n      width: \"463\",\n      height: \"284\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-wf3.webp\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-mt-settings.png\",\n      width: \"419\",\n      height: \"439\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-mt-settings.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Selecting now smoothened China and the France data in Difference widget, yields the following plot in Line Chart:\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-china-fr-quot-sm.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-china-fr-quot-sm.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The trends now seem clearer. The countries have somewhat similar trends up to 15th day, when China's growth falls decisively below the French.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Quotient plot obviously benefited from smoothing, as did the difference plot. For completeness, we added another Difference widget after Moving Transform, and plotted now smoothed difference between the two countries. Notice how the turning point is now seemingly further down the line. Orange prides itself on interactivity, so just by sliding the mouse over the plot, we get the exact information regarding the days and counts. The turning point seems to be on the 25th day.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-china-fr-diff-sm.png\",\n      width: \"1179\",\n      height: \"557\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-china-fr-diff-sm.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This blog concludes our Corona virus series for now. Until our next blog, stay safe.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2020-04-covid-19-part-3/2020-04-15-final-workflow.png\",\n      width: \"851\",\n      height: \"221\",\n      src: \"/blog/2020-04-covid-19-part-3/__webp-images__/2020-04-15-final-workflow.webp\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.p, {\n      children: [\"Orange is a multi-platform open-source machine learning and data visualization tool for beginners and experts alike. \", _jsx(_components.a, {\n        href: \"https://orange.biolab.si/download\",\n        children: \"Download Orange\"\n      }), \", and load and explore your own data sets!\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In addition to a variety of learning materials posted online in the form of\\n\", _jsx(_components.a, {\n        href: \"https://orange.biolab.si/blog/\",\n        children: \"blog posts\"\n      }), \", \", _jsx(_components.a, {\n        href: \"https://www.youtube.com/playlist?list=PLmNPvQr9Tf-ZSDLwOzxpvY-HrE0yv-8Fy\",\n        children: \"tutorial videos\"\n      }), \", we've created a Discord server. \", _jsx(_components.a, {\n        href: \"https://discord.gg/FWrfeXV\",\n        children: \"Join the community, tell us what you think!\"\n      })]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true}