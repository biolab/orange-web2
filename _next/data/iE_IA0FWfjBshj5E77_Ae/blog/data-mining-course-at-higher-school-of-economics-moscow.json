{"pageProps":{"frontmatter":{"author":"AJDA","date":"2018-05-03 11:37:28+00:00","draft":false,"title":"Data Mining Course at Higher School of Economics, Moscow","blog":["analysis","business intelligence","classification","education","examples","python","scripting","workshop"],"oldUrl":"/blog/2018/05/03/data-mining-course-at-higher-school-of-economics-moscow/"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    img: \"img\",\n    em: \"em\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Janez and I have recently returned from a two-week stay in Moscow, Russian Federation, where we were teaching data mining to MA students of \", _jsx(_components.a, {\n        href: \"https://www.hse.ru/en/ma/sna/\",\n        children: \"Applied Statistics\"\n      }), \". This is a new Master's course that attracts the best students from different backgrounds and teaches them statistical methods for work in the industry.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It was a real pleasure working at HSE. The students were proactive by asking questions and really challenged us to do our best.\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__optimized-images__/20180420_213316.jpg\",\n      alt: \"\",\n      width: \"1600\",\n      height: \"730\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"One of the things we did was compute minimum cost of misclassifications. The story goes like this. Sara is a doctor and has data on 303 patients with \", _jsx(_components.em, {\n        children: \"heart disease\"\n      }), \" (Orange's heart-disease.tab data set). She used some classifiers and now has to decide how many patients to send for further tests. Naive Bayes classifier, for example, returned probabilities of a patient being sick (column Naive Bayes 1). For each threshold in probabilites, she will compute how many false positives (patients declared sick when healthy) and how many false negatives (patients declared healthy when sick) a classifiers returns. Each mistake is associated with a cost. Now she wants to find out, how many patients to send for tests (what probability threshold to choose) so that her cost is the lowest.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"First, import all the libraries we will need:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" matplotlib.pyplot \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" plt\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" numpy \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" np\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" Orange.data \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" Table\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" Orange.classification \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" NaiveBayesLearner, TreeLearner\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"from\"\n        }), \" Orange.evaluation \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" CrossValidation\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Then load heart disease data (and print a sample).\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"heart = Table(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"heart_disease\\\"\"\n        }), \")\\n\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"print\"\n        }), \"(heart[:\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \"])\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, train classifiers and select probabilities of Naive Bayes for a patient being sick.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"scores = CrossValidation(heart, [NaiveBayesLearner(), TreeLearner()])\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#take probabilites of class 1 (sick) of NaiveBayesLearner\"\n        }), \"\\np1 = scores.probabilities[\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"][:, \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#take actual class values\"\n        }), \"\\ny = scores.actual\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#cost of false positive (patient classified as sick when healthy)\"\n        }), \"\\nfp_cost = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"500\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#cost of false negative (patient classified as healthy when sick)\"\n        }), \"\\nfn_cost = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"800\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Set counts, where we declare 0 patients being sick (threshold >1).\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"fp = \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#start with threshold above 1 (no one is sick)\"\n        }), \"\\nfn = np.\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"sum\"\n        }), \"(y)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For each threshold, compute the cost associated with each type of mistake.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"ps = []\\ncosts = []\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#compute costs of classifying i patients as sick\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" i \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" np.argsort(p1)[::-\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"]:\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" y[i] == \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \":\\n        fp += \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \":\\n        fn -= \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"\\n    ps.append(p1[i])\\n    costs.append(fp * fp_cost + fn * fn_cost)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the end, we get a list of probability thresholds and associated costs. Now let us find the minimum cost and its probability of a patient being sick.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"costs = np.array(costs)\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"#find probability of a patient being sick at lowest cost\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"print\"\n        }), \"(ps[costs.argmin()])\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This means the threshold that minimizes our cost for a given classifier is 0.620655. Sara would send all the patients with a probability of being sick higher or equal than 0.620655Â  for further tests.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At the end, we can also plot the cost to patients sent curve.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"fig, ax = plt.subplots()\\nplt.plot(ps, costs)\\nax.set_xlabel(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'Patients sent'\"\n        }), \")\\nax.set_ylabel(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'Cost'\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__optimized-images__/image-1.png\",\n      alt: \"\",\n      width: \"411\",\n      height: \"266\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"You can download the IPython Notebook here: [download id=\\\"2053\\\"].\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"thumbImage":null},"__N_SSG":true}