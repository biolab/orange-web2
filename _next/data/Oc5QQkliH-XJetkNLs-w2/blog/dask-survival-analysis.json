{"pageProps":{"frontmatter":{"author":"Jaka Koko≈°ar","date":"2023-11-08","draft":false,"title":"From Data Portals to Portals of Doom: Avoiding it with Dask","url":"dask-survival-analysis","thumbImage":"orange-not-responding-thumb.png","frontPageImage":"orange-not-responding-thumb.png","blog":["dask","survival analysis"],"shortExcerpt":"Circumvent the limitations of second-hand data portals: Orange with Dask enables you to process big data sets while ensuring the source's authenticity and enabling custom workflows.","longExcerpt":"Circumvent the limitations of second-hand data portals: Orange with Dask enables you to process big data sets while ensuring the source's authenticity and enabling custom workflows."},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components), {WindowScreenshot} = _components;\n  if (!WindowScreenshot) _missingMdxReference(\"WindowScreenshot\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Since its inception, The Cancer Genome Atlas (\", _jsx(_components.a, {\n        href: \"https://www.cancer.gov/ccg/research/genome-sequencing/tcga\",\n        children: \"TCGA\"\n      }), \") project has been a treasure trove of data for biomedical researchers. The data TCGA provides is essential for researchers who want to analyze potential biomarkers. But there's a hitch. Not every researcher is a data whisperer.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Luckily, there are several web-based tools that researchers can add to their toolkits. These tools make it easy to access and analyze survival data from TCGA. Notable examples are \", _jsx(_components.a, {\n        href: \"https://kmplot.com/analysis/\",\n        children: \"Kaplan-Meier Plotter\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"http://gepia.cancer-pku.cn/\",\n        children: \"GEPIA\"\n      }), \", among \", _jsx(_components.a, {\n        href: \"https://www.frontiersin.org/journals/oncology/articles/10.3389/fonc.2020.00068/full\",\n        children: \"others\"\n      }), \".\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2023-11-dask-survival-analysis/gepia-example.png\",\n      width: \"2730\",\n      height: \"3122\",\n      src: \"/blog/2023-11-dask-survival-analysis/__optimized-images__/gepia-example.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In their very essence, these tools allow you to enter a gene name and output the results of the analysis on pre-curated TCGA datasets. For example, in the image above, I have entered the gene name TP53 and selected the cancer type \\\"lower-grade glioma\\\" (TCGA-LGG). We see the Kaplan-Meier plot for the high- and low-risk patient groups and corresponding p-values, which quantify the difference in survival between the groups. For details, refer to a review paper by \", _jsx(_components.a, {\n        href: \"https://www.frontiersin.org/journals/oncology/articles/10.3389/fonc.2020.00068/full\",\n        children: \"Zheng and others\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Looks good; where is the catch? Well, we shouldn't blindly trust the underlying source of survival data of those web-based tools. Curated datasets between tools can vary; more in \", _jsx(_components.a, {\n        href: \"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8726696/\",\n        children: \"Idogawa et al.\"\n      }), \". And this is no small thing. Adding fuel to the fire here, I will let the reader guess how many of those tools are open-source.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Still, despite their limitations, these tools are useful. However, I would like to analyze data from sources I trust. Therefore, I have prepared \", _jsx(_components.a, {\n        href: \"https://github.com/jakakokosar/tcga-data\",\n        children: \"notebooks\"\n      }), \" that can download gene expression and survival data for all cancer types in the TCGA project. I see the irony here: I am not asking you to trust \", _jsx(_components.a, {\n        href: \"https://github.com/jakakokosar/tcga-data\",\n        children: \"my code\"\n      }), \"; if you can, verify it. Or, download from the official \", _jsx(_components.a, {\n        href: \"https://portal.gdc.cancer.gov/\",\n        children: \"GDC data portal\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The combined dataset from TCGA consists of approximately 10K samples and 60K gene expression values. The size of the file on my disk is around 3GB. You might think this is not much, but try loading it in Pandas. You will need around 30GB of system memory and 17 minutes just to read the file.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"import\"\n        }), \" pandas \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" pd\\n\\ndf = pd.read_csv(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'data/TCGA-combined.csv'\"\n        }), \")\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# peak memory: 30722.37 MiB, increment: 30597.50 MiB\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Instead of coding, could we use any existing visual analytics tools? Kaplan-Meier plotter stands out because it allows me to upload my own data (a rare find among all the other tools). That is just what I was looking for!\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2023-11-dask-survival-analysis/km-plotter-upload.png\",\n      width: \"1728\",\n      height: \"426\",\n      src: \"/blog/2023-11-dask-survival-analysis/__optimized-images__/km-plotter-upload.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The option to upload my own data is cool, but there is a 4MB limitation. What about Orange?\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2023-11-dask-survival-analysis/orange-not-responding.png\",\n      width: \"1762\",\n      height: \"1272\",\n      src: \"/blog/2023-11-dask-survival-analysis/__optimized-images__/orange-not-responding.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Well, things quickly get out of hand. Orange typically handles files that are within the range of a few hundred megabytes just fine. This, of course, also depends on the specifications of the machine that Orange is running on. To support much larger files, we extended Orange with on-disk data support, where the complete data is never loaded into memory. We used Dask as the backend for the \", _jsx(_components.a, {\n        href: \"https://github.com/biolab/orange3/wiki/Orange-with-Dask\",\n        children: \"experimental Orange version\"\n      }), \". For more, refer to the \", _jsx(_components.a, {\n        href: \"https://orangedatamining.com/blog/dask-spectroscopy/\",\n        children: \"previous blog post\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now that I can work with large datasets in Orange, I have a similar tool to those web-server-like ones: the difference is that I have to bring my own data and construct my analysis pipelines from scratch. But this is also advantageous: I am not limited to task-specific analyses that those other tools provide, and I can fully trust the data source.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here, I stratify lower-grade glioma patients (TCGA-LGG) into high- and low-risk groups according to the expression of gene TP53. Then, I use the Kaplan-Meier widget to compute and plot survival curves and test how significant the difference in survival between the groups is using the log-rank test. All this without my computer breaking a sweat!\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2023-11-dask-survival-analysis/workflow.png\",\n      width: \"2450\",\n      height: \"1900\",\n      src: \"/blog/2023-11-dask-survival-analysis/__optimized-images__/workflow.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"With the workflow I constructed above, I could click through a list of genes and observe the results. But in my data, I have a lot of genes. Clicking so many becomes a tedious task. I could automate this process with the Rank Survival Features widget. The output is the ranked list of genes based on the p-value from the log-rank test.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2023-11-dask-survival-analysis/workflow2.png\",\n      width: \"2642\",\n      height: \"1574\",\n      src: \"/blog/2023-11-dask-survival-analysis/__optimized-images__/workflow2.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"And since we have the whole TCGA datasets loaded, I could branch the same workflow and repeat the same procedure on different types of cancer and compare results side by side!\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"A \", _jsx(_components.a, {\n        href: \"https://orangedatamining.com/download/\",\n        children: \"stable Orange release\"\n      }), \" will suffice for smaller data sets. For more options, check \", _jsx(_components.a, {\n        href: \"https://orangedatamining.com/examples/?tag=Survival+Analysis\",\n        children: \"the library of survival analysis workflows\"\n      }), \". You will find workflows that range from simple survival curve estimation to more complex analysis using Cox regression are readily available to experiment with.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Thats it! You can download and try \", _jsx(_components.a, {\n        href: \"/blog/2023-11-dask-survival-analysis/full-workflow.ows\",\n        children: \"the full workflow\"\n      }), \". Remember: for big data sets, use the \", _jsx(_components.a, {\n        href: \"https://github.com/biolab/orange3/wiki/Orange-with-Dask\",\n        children: \"experimental Orange version\"\n      }), \".\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}},"thumbImage":{"width":1396,"height":854,"src":"/blog/2023-11-dask-survival-analysis/__optimized-images__/orange-not-responding-thumb.png"}},"__N_SSG":true}