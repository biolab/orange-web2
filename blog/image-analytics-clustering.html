<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-45fae5f2ec2ec297.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-abafce5311b78c60.js" defer=""></script><script src="/_next/static/chunks/pages/_app-463eea64dd46fd78.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-9737114052c0c44f.js" defer=""></script><script src="/_next/static/Pq4MTEXwxi3akD3CFvrRB/_buildManifest.js" defer=""></script><script src="/_next/static/Pq4MTEXwxi3akD3CFvrRB/_ssgManifest.js" defer=""></script></head><body><div id="__next"><nav class="navbar__Nav-sc-q11qw3-0 hZTkcw"><ul><a href="/blog">Blog</a></ul><button class="navbar__Burger-sc-q11qw3-1 cGMLJw">X</button></nav><main><div class="slug__Wrapper-sc-1xtdpf8-0 cHTstd"><h1>Image Analytics: Clustering</h1><p>Data does not always come in a nice tabular form. It can also be a collection of text, audio recordings, video materials or even images. However, computers can only work with numbers, so for any data mining, we need to transform such unstructured data into a vector representation.</p>
<p>For retrieving numbers from unstructured data, <a href="http://orange.biolab.si">Orange</a> can use deep network embedders. We have just started to include various embedders in Orange, and for now, they are available for text and images.</p>
<p><strong>Related:</strong> <a href="https://www.youtube.com/watch?v=Iu8g2Twjn9U">Video on image clustering</a></p>
<p>Here, we give an example of image embedding and show how easy is to use it in Orange. Technically, Orange would send the image to the server, where the server would push an image through a pre-trained deep neural network, like <a href="https://www.tensorflow.org/tutorials/image_recognition">Google&#x27;s Inception v3</a>. Deep networks were most often trained with some special purpose in mind. Inception v3, for instance, can classify images into any of <a href="http://image-net.org/challenges/LSVRC/2014/browse-synsets">1000 image classes</a>. We can disregard the classification, consider instead the penultimate layer of the network with 2048 nodes (numbers) and use that for image&#x27;s vector-based representation.</p>
<p>Let&#x27;s see this on an example.</p>
<p>Here we have 19 <a href="http://tinyurl.com/images-domestic-animals">images of domestic animals</a>. First, download the images and unzip them. Then use Import Images widget from Orange&#x27;s Image Analytics add-on and open the directory containing the images.</p>
<p><img src="/blog/2017-04-image-analytics-clustering/ImportImages.png" alt=""/></p>
<p>We can visualize images in Image Viewer widget. Here is our workflow so far, with images shown in Image Viewer:</p>
<p><img src="/blog/2017-04-image-analytics-clustering/image-viewer.png" alt=""/></p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.07.36.png" alt=""/></p>
<p>But what do we see in a data table? Only some useless description of images (file name, the location of the file, its size, and the image width and height).</p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.11.06.png" alt=""/></p>
<p>This cannot help us with machine learning. As I said before, we need numbers. To acquire numerical representation of these images, we will send the images to Image Embedding widget.</p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.15.50.png" alt=""/></p>
<p>Great! Now we have the numbers we wanted. There are 2048 of them (columns n0 to n2047). From now on, we can apply all the standard machine learning techniques, say, clustering.</p>
<p>Let us measure the distance between these images and see which are the most similar. We used Distances widget to measure the distance. Normally, cosine distance works best for images, but you can experiment on your own. Then we passed the distance matrix to Hierarchical Clustering to visualize similar pairs in a dendrogram.</p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.20.38.png" alt=""/></p>
<p>This looks very promising! All the right animals are grouped together. But I can&#x27;t see the results so well in the dendrogram. I want to see the images - with Image Viewer!</p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.23.38.png" alt=""/></p>
<p>So cool! All the cow family is grouped together! Now we can click on different branches of the dendrogram and observe which animals belong to which group.</p>
<p>But I know what you are going to say. You are going to say I am cheating. That I intentionally selected similar images to trick you.</p>
<p>I will prove you wrong. I will take a new cow, say, the most famous cow in Europe - Milka cow.</p>
<p><img src="/blog/2017-04-image-analytics-clustering/milka_cow_by_miki3d.jpg" alt=""/></p>
<p>This image is quite different from the other images - it doesn&#x27;t have a white background, it&#x27;s a real (yet photoshopped) photo and the cow is facing us. Will the Image Embedding find the right numerical representation for this cow?</p>
<p><img src="/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.30.41.png" alt=""/></p>
<p>Indeed it has. Milka is nicely put together with all the other cows.</p>
<p>Image analytics is such an exciting field in machine learning and now Orange is a part of it too! You need to install the Image Analytics add on and you are all set for your research!</p></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"author":"AJDA","date":"2017-04-03 12:36:22+00:00","draft":false,"title":"Image Analytics: Clustering","type":"blog","blog":["addons","analysis","clustering","embedding","images","interactive  data visualization","orange3","unsupervised"]},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    strong: \"strong\",\n    img: \"img\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Data does not always come in a nice tabular form. It can also be a collection of text, audio recordings, video materials or even images. However, computers can only work with numbers, so for any data mining, we need to transform such unstructured data into a vector representation.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For retrieving numbers from unstructured data, \", _jsx(_components.a, {\n        href: \"http://orange.biolab.si\",\n        children: \"Orange\"\n      }), \" can use deep network embedders. We have just started to include various embedders in Orange, and for now, they are available for text and images.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Related:\"\n      }), \" \", _jsx(_components.a, {\n        href: \"https://www.youtube.com/watch?v=Iu8g2Twjn9U\",\n        children: \"Video on image clustering\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here, we give an example of image embedding and show how easy is to use it in Orange. Technically, Orange would send the image to the server, where the server would push an image through a pre-trained deep neural network, like \", _jsx(_components.a, {\n        href: \"https://www.tensorflow.org/tutorials/image_recognition\",\n        children: \"Google's Inception v3\"\n      }), \". Deep networks were most often trained with some special purpose in mind. Inception v3, for instance, can classify images into any of \", _jsx(_components.a, {\n        href: \"http://image-net.org/challenges/LSVRC/2014/browse-synsets\",\n        children: \"1000 image classes\"\n      }), \". We can disregard the classification, consider instead the penultimate layer of the network with 2048 nodes (numbers) and use that for image's vector-based representation.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's see this on an example.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here we have 19 \", _jsx(_components.a, {\n        href: \"http://tinyurl.com/images-domestic-animals\",\n        children: \"images of domestic animals\"\n      }), \". First, download the images and unzip them. Then use Import Images widget from Orange's Image Analytics add-on and open the directory containing the images.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/ImportImages.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can visualize images in Image Viewer widget. Here is our workflow so far, with images shown in Image Viewer:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/image-viewer.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.07.36.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"But what do we see in a data table? Only some useless description of images (file name, the location of the file, its size, and the image width and height).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.11.06.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This cannot help us with machine learning. As I said before, we need numbers. To acquire numerical representation of these images, we will send the images to Image Embedding widget.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.15.50.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Great! Now we have the numbers we wanted. There are 2048 of them (columns n0 to n2047). From now on, we can apply all the standard machine learning techniques, say, clustering.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let us measure the distance between these images and see which are the most similar. We used Distances widget to measure the distance. Normally, cosine distance works best for images, but you can experiment on your own. Then we passed the distance matrix to Hierarchical Clustering to visualize similar pairs in a dendrogram.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.20.38.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This looks very promising! All the right animals are grouped together. But I can't see the results so well in the dendrogram. I want to see the images - with Image Viewer!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.23.38.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So cool! All the cow family is grouped together! Now we can click on different branches of the dendrogram and observe which animals belong to which group.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"But I know what you are going to say. You are going to say I am cheating. That I intentionally selected similar images to trick you.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I will prove you wrong. I will take a new cow, say, the most famous cow in Europe - Milka cow.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/milka_cow_by_miki3d.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This image is quite different from the other images - it doesn't have a white background, it's a real (yet photoshopped) photo and the cow is facing us. Will the Image Embedding find the right numerical representation for this cow?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/blog/2017-04-image-analytics-clustering/Screen-Shot-2017-03-29-at-10.30.41.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Indeed it has. Milka is nicely put together with all the other cows.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Image analytics is such an exciting field in machine learning and now Orange is a part of it too! You need to install the Image Analytics add on and you are all set for your research!\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"image-analytics-clustering"},"buildId":"Pq4MTEXwxi3akD3CFvrRB","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>