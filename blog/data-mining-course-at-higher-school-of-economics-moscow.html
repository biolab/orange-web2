<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Orange Data Mining</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/media/e7c7dbb62ddcf6fa-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/148a6a0ea3cd708f.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/148a6a0ea3cd708f.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/4ac7ed34d61ef456.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/4ac7ed34d61ef456.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-21c828b96ad33382.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-ab94bcaa7cae018a.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-0e91bb05b464011b.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/110-f463c991b9377c97.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-5cae9985e3b1ec98.js" defer="" crossorigin=""></script><script src="/_next/static/WY0ynjJWix5MqmqI6ESfa/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/WY0ynjJWix5MqmqI6ESfa/_ssgManifest.js" defer="" crossorigin=""></script><style data-styled="" data-styled-version="5.3.6">.iSNtvJ{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;}/*!sc*/
@media (max-width:1130px){.iSNtvJ{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.iSNtvJ{padding-left:15px;padding-right:15px;}}/*!sc*/
.fJLXpS{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;max-width:714px;}/*!sc*/
@media (max-width:1130px){.fJLXpS{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.fJLXpS{padding-left:15px;padding-right:15px;}}/*!sc*/
data-styled.g1[id="sc-ef15f394-0"]{content:"iSNtvJ,fJLXpS,"}/*!sc*/
.jyxOJT{position:relative;display:inline-block;max-width:100%;font-size:20px;line-height:1.25;font-weight:600;-webkit-text-decoration:none;text-decoration:none;color:#fff;padding:10px 15px;border-radius:5px;background-image:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);background-size:100%;cursor:pointer;z-index:2;}/*!sc*/
@media (max-width:720px){.jyxOJT{font-size:18px;}}/*!sc*/
.jyxOJT:before{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;background-image:linear-gradient(180deg,#ffbc44 100%,#FE7A00 100%);opacity:0;z-index:-100;-webkit-transition:opacity 0.45s;transition:opacity 0.45s;}/*!sc*/
.jyxOJT:hover{color:#fff;}/*!sc*/
.jyxOJT:hover:before{opacity:1;}/*!sc*/
data-styled.g2[id="sc-b6ea565a-0"]{content:"jyxOJT,"}/*!sc*/
.iQtqNS{background:#1F1F1F;padding:38px 0 25px;color:#fff;}/*!sc*/
data-styled.g3[id="sc-c82ca4e2-0"]{content:"iQtqNS,"}/*!sc*/
.iiCJUO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-column-gap:80px;column-gap:80px;row-gap:40px;margin-bottom:40px;}/*!sc*/
@media (max-width:720px){.iiCJUO{display:grid;grid-template-columns:1fr 1fr;-webkit-column-gap:20px;column-gap:20px;}}/*!sc*/
.iiCJUO h3{font-size:16px;font-weight:600;margin-bottom:12px;}/*!sc*/
.iiCJUO li + li{margin-top:12px;}/*!sc*/
data-styled.g4[id="sc-c82ca4e2-1"]{content:"iiCJUO,"}/*!sc*/
.eWdALT{display:none;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:44px;height:34px;padding:6px;border-radius:5px;border:none;background:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);cursor:pointer;margin-left:auto;}/*!sc*/
@media (max-width:920px){.eWdALT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
.eWdALT div{width:22px;height:2px;background:#fff;-webkit-transform-origin:1px;-ms-transform-origin:1px;transform-origin:1px;-webkit-transition:all 0.3s linear;transition:all 0.3s linear;}/*!sc*/
data-styled.g5[id="sc-46d6b9d9-0"]{content:"eWdALT,"}/*!sc*/
.jTcDmc{-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;}/*!sc*/
data-styled.g6[id="sc-cdea7863-0"]{content:"jTcDmc,"}/*!sc*/
.gPgccM{position:fixed;top:0;left:0;width:100%;height:80px;z-index:5;background:#fff;box-shadow:0px 4px 10px 4px rgba(0,0,0,0.04);}/*!sc*/
data-styled.g7[id="sc-6852f5f6-0"]{content:"gPgccM,"}/*!sc*/
.jrLPNu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}/*!sc*/
.jrLPNu .img-logo{width:115px;}/*!sc*/
data-styled.g8[id="sc-6852f5f6-1"]{content:"jrLPNu,"}/*!sc*/
.hzGhxs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.hzGhxs{display:block;position:absolute;top:80px;left:0;width:100%;z-index:1;padding:0 30px 30px;background-color:#fff;opacity:0;z-index:-9999;pointer-events:none;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;box-shadow:0 4px 10px -1px rgba(0,0,0,0.04);}}/*!sc*/
@media (max-width:720px){.hzGhxs{padding:0 15px 15px;}}/*!sc*/
data-styled.g9[id="sc-6852f5f6-2"]{content:"hzGhxs,"}/*!sc*/
.chSgxF{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.chSgxF{display:block;margin-bottom:15px;}}/*!sc*/
.chSgxF li + li{margin-left:26px;}/*!sc*/
@media (max-width:920px){.chSgxF li + li{margin-left:0;}}/*!sc*/
.chSgxF a{display:inline-block;font-size:1.25rem;line-height:1;color:#000000;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.3s;transition:color 0.3s;}/*!sc*/
.chSgxF a:hover{color:#FE7A00;}/*!sc*/
@media (max-width:920px){.chSgxF a{padding:8px 0;}}/*!sc*/
data-styled.g10[id="sc-6852f5f6-3"]{content:"chSgxF,"}/*!sc*/
.hTbjmy{position:relative;width:160px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;margin-left:26px;}/*!sc*/
@media (max-width:920px){.hTbjmy{width:auto;margin-left:0;}}/*!sc*/
data-styled.g11[id="sc-6852f5f6-4"]{content:"hTbjmy,"}/*!sc*/
.kzOElI{display:inline-block;position:absolute;top:0;right:42px;width:calc(100% - 42px);height:100%;font-size:16px;line-height:1.25;padding:10px 13px;background:#fff;border-radius:5px 0px 0px 5px;border:1px solid #D9D9D9;border-right:none;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;}/*!sc*/
@media (max-width:920px){.kzOElI{display:none;}}/*!sc*/
.kzOElI::-webkit-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::-moz-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI:-ms-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::placeholder{color:#D9D9D9;}/*!sc*/
data-styled.g12[id="sc-6852f5f6-5"]{content:"kzOElI,"}/*!sc*/
.dSfmcG{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:#fff;margin-left:auto;-webkit-flex:0 0 42px;-ms-flex:0 0 42px;flex:0 0 42px;height:41px;border:1px solid #474747;border-radius:0px 5px 5px 0px;background-color:#474747;}/*!sc*/
@media (max-width:920px){.dSfmcG{margin-left:0;}}/*!sc*/
data-styled.g13[id="sc-6852f5f6-6"]{content:"dSfmcG,"}/*!sc*/
.eBQFeB{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
data-styled.g18[id="sc-da66f971-0"]{content:"eBQFeB,"}/*!sc*/
*,*:before,*:after{box-sizing:border-box;-webkit-font-smoothing:antialiased;}/*!sc*/
html,body{height:100%;margin:0;}/*!sc*/
html{font-family:'Source Sans Pro',sans-serif;font-weight:400;color:#000000;}/*!sc*/
body{background:#fff;}/*!sc*/
body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:normal;}/*!sc*/
main{padding-top:80px;-webkit-flex:1;-ms-flex:1;flex:1;}/*!sc*/
ol,ul{list-style:none;}/*!sc*/
figure{margin:0;}/*!sc*/
img,video{display:block;max-width:100%;height:auto;}/*!sc*/
a{color:unset;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
a:hover{color:unset;}/*!sc*/
strong{font-weight:600;}/*!sc*/
pre{display:block;padding:10px 14px;margin:0 0 10px;font-size:18px;line-height:1.42857143;word-break:break-all;word-wrap:break-word;color:#000;background-color:#f5f5f5;border-radius:5px;overflow-x:auto;word-wrap:normal;}/*!sc*/
pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0;}/*!sc*/
code{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;white-space:nowrap;border-radius:4px;white-space:pre-wrap;}/*!sc*/
::selection{background-color:#FE7A00;color:#fff;}/*!sc*/
.lg-container .lg-backdrop.in{opacity:0.75;}/*!sc*/
.lg-container .lg-toolbar.lg-group,.lg-container .lg-outer .lg-thumb-outer{background:rgba(0,0,0,0.45);}/*!sc*/
data-styled.g19[id="sc-global-gFJXlm1"]{content:"sc-global-gFJXlm1,"}/*!sc*/
.cXdfZy{font-size:62px;line-height:1.04;font-weight:700;color:#fff;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.cXdfZy{font-size:50px;}}/*!sc*/
@media (max-width:720px){.cXdfZy{font-size:42px;}}/*!sc*/
data-styled.g20[id="sc-4d34df46-0"]{content:"cXdfZy,"}/*!sc*/
.htQmXI h1{font-size:44px;line-height:1.13;font-weight:700;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h1{font-size:38px;}}/*!sc*/
@media (max-width:720px){.htQmXI h1{font-size:32px;}}/*!sc*/
.htQmXI h2{font-size:33px;line-height:1.13;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h2{font-size:30px;}}/*!sc*/
@media (max-width:720px){.htQmXI h2{font-size:26px;}}/*!sc*/
.htQmXI h3{font-size:28px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h3{font-size:26px;}}/*!sc*/
@media (max-width:720px){.htQmXI h3{font-size:24px;}}/*!sc*/
.htQmXI h4{font-size:22px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:720px){.htQmXI h4{font-size:20px;}}/*!sc*/
.htQmXI p{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI p{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI p{font-size:18px;}}/*!sc*/
.htQmXI ul,.htQmXI ol{padding-left:40px;}/*!sc*/
.htQmXI ul li,.htQmXI ol li{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI ul li,.htQmXI ol li{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI ul li,.htQmXI ol li{font-size:18px;}}/*!sc*/
.htQmXI ul li + li,.htQmXI ol li + li{margin-top:4px;}/*!sc*/
.htQmXI ul{list-style:disc;}/*!sc*/
.htQmXI ol{list-style:decimal;}/*!sc*/
.htQmXI p a,.htQmXI li a{color:#FE7A00;}/*!sc*/
.htQmXI p a:hover,.htQmXI li a:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.htQmXI * + *:not(li,a){margin-top:15px;}/*!sc*/
.htQmXI * + a[data-gallery],.htQmXI * + video{margin-top:40px;}/*!sc*/
.htQmXI a[data-gallery]{display:block;margin-bottom:40px;}/*!sc*/
.htQmXI iframe,.htQmXI video{margin-bottom:40px;}/*!sc*/
data-styled.g23[id="sc-b0f3732d-0"]{content:"htQmXI,"}/*!sc*/
.jiUdjB{padding:80px 0;}/*!sc*/
@media (max-width:920px){.jiUdjB{padding:60px 0;}}/*!sc*/
@media (max-width:720px){.jiUdjB{padding:40px 0;}}/*!sc*/
data-styled.g26[id="sc-18ad0c3-0"]{content:"jiUdjB,"}/*!sc*/
.farhVs{margin-bottom:30px;}/*!sc*/
data-styled.g27[id="sc-18ad0c3-1"]{content:"farhVs,"}/*!sc*/
.evzqvZ{position:relative;}/*!sc*/
data-styled.g28[id="sc-18ad0c3-2"]{content:"evzqvZ,"}/*!sc*/
.kwRhph{position:absolute;top:0;right:100%;width:200px;margin-right:50px;text-align:right;}/*!sc*/
@media (max-width:1130px){.kwRhph{position:unset;width:auto;text-align:left;margin:0 0 30px 0;}}/*!sc*/
data-styled.g29[id="sc-18ad0c3-3"]{content:"kwRhph,"}/*!sc*/
.jMsRbj{font-size:20px;line-height:1.25;color:#1F1F1F;text-transform:capitalize;color:#5651EC;}/*!sc*/
@media (max-width:920px){.jMsRbj{font-size:18px;}}/*!sc*/
.cwWTdU{font-size:20px;line-height:1.25;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.cwWTdU{font-size:18px;}}/*!sc*/
data-styled.g30[id="sc-18ad0c3-4"]{content:"jMsRbj,cwWTdU,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-da66f971-0 eBQFeB __className_667be3"><nav class="sc-6852f5f6-0 gPgccM"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-6852f5f6-1 jrLPNu"><a href="/"><img alt="Orange Logo" loading="lazy" width="120" height="35" decoding="async" data-nimg="1" class="img-logo" style="color:transparent" src="/_next/static/media/logo-orange.faff1861.svg"/></a><div><button aria-label="Toggle navigation" class="sc-46d6b9d9-0 eWdALT"><div></div><div></div><div></div></button><div class="sc-6852f5f6-2 hzGhxs"><ul class="sc-6852f5f6-3 chSgxF"><li><a href="/examples">Examples</a></li><li><a href="/download">Download</a></li><li><a href="/blog">Blog</a></li><li><a href="/docs">Docs</a></li><li><a href="/workshops">Workshops</a></li></ul><form class="sc-6852f5f6-4 hTbjmy"><div class="sc-6852f5f6-5 kzOElI">Search</div><button class="sc-6852f5f6-6 dSfmcG"><img alt="Icon for search" loading="lazy" width="18" height="17" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/icon-search.459b2665.svg"/><span class="sc-cdea7863-0 jTcDmc">Search through page</span></button></form></div></div></div></div></nav><main><div class="sc-18ad0c3-0 jiUdjB"><div class="sc-ef15f394-0 fJLXpS"><div class="sc-18ad0c3-1 farhVs"><p class="sc-18ad0c3-4 jMsRbj"><strong>analysis, business intelligence, classification, education, examples, python, scripting, workshop</strong></p><h1 class="sc-4d34df46-0 cXdfZy">Data Mining Course at Higher School of Economics, Moscow</h1></div><div class="sc-18ad0c3-2 evzqvZ"><div class="sc-18ad0c3-3 kwRhph"><p class="sc-18ad0c3-4 cwWTdU"><strong>AJDA</strong></p><p class="sc-18ad0c3-4 cwWTdU">May 03, 2018</p></div><div class="sc-b0f3732d-0 htQmXI"><div class="lg-react-element "><p>Janez and I have recently returned from a two-week stay in Moscow, Russian Federation, where we were teaching data mining to MA students of <a href="https://www.hse.ru/en/ma/sna/">Applied Statistics</a>. This is a new Master&#x27;s course that attracts the best students from different backgrounds and teaches them statistical methods for work in the industry.</p>
<p>It was a real pleasure working at HSE. The students were proactive by asking questions and really challenged us to do our best.</p>
<a href="/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/20180420_213316.webp" data-gallery="true"><img alt="" loading="lazy" width="1600" height="730" decoding="async" data-nimg="1" style="color:transparent" src="/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/20180420_213316.webp"/></a>
<p>One of the things we did was compute minimum cost of misclassifications. The story goes like this. Sara is a doctor and has data on 303 patients with <em>heart disease</em> (Orange&#x27;s heart-disease.tab data set). She used some classifiers and now has to decide how many patients to send for further tests. Naive Bayes classifier, for example, returned probabilities of a patient being sick (column Naive Bayes 1). For each threshold in probabilites, she will compute how many false positives (patients declared sick when healthy) and how many false negatives (patients declared healthy when sick) a classifiers returns. Each mistake is associated with a cost. Now she wants to find out, how many patients to send for tests (what probability threshold to choose) so that her cost is the lowest.</p>
<p>First, import all the libraries we will need:</p>
<pre><code>    import matplotlib.pyplot as plt
    import numpy as np
    
    from Orange.data import Table
    from Orange.classification import NaiveBayesLearner, TreeLearner
    from Orange.evaluation import CrossValidation
</code></pre>
<p>Then load heart disease data (and print a sample).</p>
<pre><code>    heart = Table(&quot;heart_disease&quot;)
    print(heart[:5])
</code></pre>
<p>Now, train classifiers and select probabilities of Naive Bayes for a patient being sick.</p>
<pre><code>    scores = CrossValidation(heart, [NaiveBayesLearner(), TreeLearner()])
    
    #take probabilites of class 1 (sick) of NaiveBayesLearner
    p1 = scores.probabilities[0][:, 1]
    
    #take actual class values
    y = scores.actual
    
    #cost of false positive (patient classified as sick when healthy)
    fp_cost = 500
    
    #cost of false negative (patient classified as healthy when sick)
    fn_cost = 800
</code></pre>
<p>Set counts, where we declare 0 patients being sick (threshold &gt;1).</p>
<pre><code>    fp = 0
    #start with threshold above 1 (no one is sick)
    fn = np.sum(y)
</code></pre>
<p>For each threshold, compute the cost associated with each type of mistake.</p>
<pre><code>    ps = []
    costs = []
    
    #compute costs of classifying i patients as sick
    for i in np.argsort(p1)[::-1]:
        if y[i] == 0:
            fp += 1
        else:
            fn -= 1
        ps.append(p1[i])
        costs.append(fp * fp_cost + fn * fn_cost)
</code></pre>
<p>In the end, we get a list of probability thresholds and associated costs. Now let us find the minimum cost and its probability of a patient being sick.</p>
<pre><code>    costs = np.array(costs)
    #find probability of a patient being sick at lowest cost
    print(ps[costs.argmin()])
</code></pre>
<p>This means the threshold that minimizes our cost for a given classifier is 0.620655. Sara would send all the patients with a probability of being sick higher or equal than 0.620655  for further tests.</p>
<p>At the end, we can also plot the cost to patients sent curve.</p>
<pre><code>    fig, ax = plt.subplots()
    plt.plot(ps, costs)
    ax.set_xlabel(&#x27;Patients sent&#x27;)
    ax.set_ylabel(&#x27;Cost&#x27;)
</code></pre>
<a href="/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/image-1.webp" data-gallery="true"><img alt="" loading="lazy" width="411" height="266" decoding="async" data-nimg="1" style="color:transparent" src="/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/image-1.webp"/></a>
<p>You can download the IPython Notebook here: [download id=&quot;2053&quot;].</p></div></div></div></div></div></main><footer class="sc-c82ca4e2-0 iQtqNS"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-c82ca4e2-1 iiCJUO"><div><h3>Orange</h3><ul><li><a href="/faq">FAQ</a></li><li><a href="/license">License</a></li><li><a href="/privacy">Privacy</a></li><li><a href="/citation">Citation</a></li><li><a href="/contact">Contact</a></li></ul></div><div><h3>Download</h3><ul><li><a href="/download#win">Windows</a></li><li><a href="/download#mac">Mac OS</a></li></ul></div><div><h3>Community</h3><ul><li><a href="https://twitter.com/OrangeDataMiner">Twitter</a></li><li><a href="https://www.facebook.com/orangedatamining">Facebook</a></li><li><a href="https://datascience.stackexchange.com/questions/tagged/orange">Stack Exchange</a></li><li><a href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g">YouTube</a></li><li><a href="https://discord.com/invite/FWrfeXV">Discord</a></li></ul></div><div><h3>Documentation</h3><ul><li><a href="/getting-started">Get started</a></li><li><a href="/widget-catalogue">Widgets</a></li><li><a href="https://orange3.readthedocs.io/projects/orange-data-mining-library/en/latest/">Scripting</a></li></ul></div><div><h3>Developers</h3><ul><li><a href="https://github.com/biolab/orange3">GitHub</a></li><li><a href="http://docs.biolab.si/3/development/">Getting started</a></li></ul></div><div><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J" target="_blank" rel="noreferrer" class="sc-b6ea565a-0 jyxOJT">Donate to Orange</a></div></div><p>Copyright © University of Ljubljana</p></div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontmatter":{"author":"AJDA","date":"2018-05-03 11:37:28+00:00","draft":false,"title":"Data Mining Course at Higher School of Economics, Moscow","blog":["analysis","business intelligence","classification","education","examples","python","scripting","workshop"],"oldUrl":"/blog/2018/05/03/data-mining-course-at-higher-school-of-economics-moscow/"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    img: \"img\",\n    em: \"em\",\n    pre: \"pre\",\n    code: \"code\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Janez and I have recently returned from a two-week stay in Moscow, Russian Federation, where we were teaching data mining to MA students of \", _jsx(_components.a, {\n        href: \"https://www.hse.ru/en/ma/sna/\",\n        children: \"Applied Statistics\"\n      }), \". This is a new Master's course that attracts the best students from different backgrounds and teaches them statistical methods for work in the industry.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It was a real pleasure working at HSE. The students were proactive by asking questions and really challenged us to do our best.\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/20180420_213316.webp\",\n      alt: \"\",\n      width: \"1600\",\n      height: \"730\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"One of the things we did was compute minimum cost of misclassifications. The story goes like this. Sara is a doctor and has data on 303 patients with \", _jsx(_components.em, {\n        children: \"heart disease\"\n      }), \" (Orange's heart-disease.tab data set). She used some classifiers and now has to decide how many patients to send for further tests. Naive Bayes classifier, for example, returned probabilities of a patient being sick (column Naive Bayes 1). For each threshold in probabilites, she will compute how many false positives (patients declared sick when healthy) and how many false negatives (patients declared healthy when sick) a classifiers returns. Each mistake is associated with a cost. Now she wants to find out, how many patients to send for tests (what probability threshold to choose) so that her cost is the lowest.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"First, import all the libraries we will need:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    import matplotlib.pyplot as plt\\n    import numpy as np\\n    \\n    from Orange.data import Table\\n    from Orange.classification import NaiveBayesLearner, TreeLearner\\n    from Orange.evaluation import CrossValidation\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Then load heart disease data (and print a sample).\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    heart = Table(\\\"heart_disease\\\")\\n    print(heart[:5])\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, train classifiers and select probabilities of Naive Bayes for a patient being sick.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    scores = CrossValidation(heart, [NaiveBayesLearner(), TreeLearner()])\\n    \\n    #take probabilites of class 1 (sick) of NaiveBayesLearner\\n    p1 = scores.probabilities[0][:, 1]\\n    \\n    #take actual class values\\n    y = scores.actual\\n    \\n    #cost of false positive (patient classified as sick when healthy)\\n    fp_cost = 500\\n    \\n    #cost of false negative (patient classified as healthy when sick)\\n    fn_cost = 800\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Set counts, where we declare 0 patients being sick (threshold \u003e1).\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    fp = 0\\n    #start with threshold above 1 (no one is sick)\\n    fn = np.sum(y)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For each threshold, compute the cost associated with each type of mistake.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    ps = []\\n    costs = []\\n    \\n    #compute costs of classifying i patients as sick\\n    for i in np.argsort(p1)[::-1]:\\n        if y[i] == 0:\\n            fp += 1\\n        else:\\n            fn -= 1\\n        ps.append(p1[i])\\n        costs.append(fp * fp_cost + fn * fn_cost)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the end, we get a list of probability thresholds and associated costs. Now let us find the minimum cost and its probability of a patient being sick.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    costs = np.array(costs)\\n    #find probability of a patient being sick at lowest cost\\n    print(ps[costs.argmin()])\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This means the threshold that minimizes our cost for a given classifier is 0.620655. Sara would send all the patients with a probability of being sick higher or equal than 0.620655  for further tests.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At the end, we can also plot the cost to patients sent curve.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    fig, ax = plt.subplots()\\n    plt.plot(ps, costs)\\n    ax.set_xlabel('Patients sent')\\n    ax.set_ylabel('Cost')\\n\"\n      })\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/blog/2018-05-data-mining-course-at-higher-school-of-economics-moscow/__webp-images__/image-1.webp\",\n      alt: \"\",\n      width: \"411\",\n      height: \"266\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"You can download the IPython Notebook here: [download id=\\\"2053\\\"].\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"data-mining-course-at-higher-school-of-economics-moscow"},"buildId":"WY0ynjJWix5MqmqI6ESfa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>