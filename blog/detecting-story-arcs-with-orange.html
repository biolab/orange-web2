<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="description" content="Orange Data Mining Toolbox"/><meta property="og:url" content="https://orangedatamining.com"/><meta property="og:site_name" content="Orange Data Mining"/><meta name="author" content="Bioinformatics Laboratory, University of Ljubljana"/><title>Orange Data Mining - Detecting Story Arcs with Orange</title><meta name="robots" content="index,follow"/><meta property="og:title" content="Orange Data Mining - Detecting Story Arcs with Orange"/><meta property="og:description" content="How to detect and analyze story arcs in a corpus."/><meta property="og:type" content="blog"/><meta property="og:image" content="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-story-arcs-small.webp"/><meta property="og:image:width" content="599"/><meta property="og:image:height" content="400"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/media/e7c7dbb62ddcf6fa-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/148a6a0ea3cd708f.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/148a6a0ea3cd708f.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/4ac7ed34d61ef456.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/4ac7ed34d61ef456.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-21c828b96ad33382.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-ab94bcaa7cae018a.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-2a4752ea2b2135bc.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/110-f463c991b9377c97.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-30c4b2064ff42c75.js" defer="" crossorigin=""></script><script src="/_next/static/hMev--kvhv30RuWEFrRTZ/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/hMev--kvhv30RuWEFrRTZ/_ssgManifest.js" defer="" crossorigin=""></script><style data-styled="" data-styled-version="5.3.6">.iSNtvJ{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;}/*!sc*/
@media (max-width:1130px){.iSNtvJ{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.iSNtvJ{padding-left:15px;padding-right:15px;}}/*!sc*/
.fJLXpS{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;max-width:714px;}/*!sc*/
@media (max-width:1130px){.fJLXpS{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.fJLXpS{padding-left:15px;padding-right:15px;}}/*!sc*/
data-styled.g1[id="sc-ef15f394-0"]{content:"iSNtvJ,fJLXpS,"}/*!sc*/
.jyxOJT{position:relative;display:inline-block;max-width:100%;font-size:20px;line-height:1.25;font-weight:600;-webkit-text-decoration:none;text-decoration:none;color:#fff;padding:10px 15px;border-radius:5px;background-image:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);background-size:100%;cursor:pointer;z-index:2;}/*!sc*/
@media (max-width:720px){.jyxOJT{font-size:18px;}}/*!sc*/
.jyxOJT:before{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;background-image:linear-gradient(180deg,#ffbc44 100%,#FE7A00 100%);opacity:0;z-index:-100;-webkit-transition:opacity 0.45s;transition:opacity 0.45s;}/*!sc*/
.jyxOJT:hover{color:#fff;}/*!sc*/
.jyxOJT:hover:before{opacity:1;}/*!sc*/
data-styled.g2[id="sc-b6ea565a-0"]{content:"jyxOJT,"}/*!sc*/
.iQtqNS{background:#1F1F1F;padding:38px 0 25px;color:#fff;}/*!sc*/
data-styled.g3[id="sc-c82ca4e2-0"]{content:"iQtqNS,"}/*!sc*/
.iiCJUO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-column-gap:80px;column-gap:80px;row-gap:40px;margin-bottom:40px;}/*!sc*/
@media (max-width:720px){.iiCJUO{display:grid;grid-template-columns:1fr 1fr;-webkit-column-gap:20px;column-gap:20px;}}/*!sc*/
.iiCJUO h3{font-size:16px;font-weight:600;margin-bottom:12px;}/*!sc*/
.iiCJUO li + li{margin-top:12px;}/*!sc*/
data-styled.g4[id="sc-c82ca4e2-1"]{content:"iiCJUO,"}/*!sc*/
.eWdALT{display:none;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:44px;height:34px;padding:6px;border-radius:5px;border:none;background:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);cursor:pointer;margin-left:auto;}/*!sc*/
@media (max-width:920px){.eWdALT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
.eWdALT div{width:22px;height:2px;background:#fff;-webkit-transform-origin:1px;-ms-transform-origin:1px;transform-origin:1px;-webkit-transition:all 0.3s linear;transition:all 0.3s linear;}/*!sc*/
data-styled.g5[id="sc-46d6b9d9-0"]{content:"eWdALT,"}/*!sc*/
.jTcDmc{-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;}/*!sc*/
data-styled.g6[id="sc-cdea7863-0"]{content:"jTcDmc,"}/*!sc*/
.gPgccM{position:fixed;top:0;left:0;width:100%;height:80px;z-index:5;background:#fff;box-shadow:0px 4px 10px 4px rgba(0,0,0,0.04);}/*!sc*/
data-styled.g7[id="sc-6852f5f6-0"]{content:"gPgccM,"}/*!sc*/
.jrLPNu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}/*!sc*/
.jrLPNu .img-logo{width:115px;}/*!sc*/
data-styled.g8[id="sc-6852f5f6-1"]{content:"jrLPNu,"}/*!sc*/
.hzGhxs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.hzGhxs{display:block;position:absolute;top:80px;left:0;width:100%;z-index:1;padding:0 30px 30px;background-color:#fff;opacity:0;z-index:-9999;pointer-events:none;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;box-shadow:0 4px 10px -1px rgba(0,0,0,0.04);}}/*!sc*/
@media (max-width:720px){.hzGhxs{padding:0 15px 15px;}}/*!sc*/
data-styled.g9[id="sc-6852f5f6-2"]{content:"hzGhxs,"}/*!sc*/
.chSgxF{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.chSgxF{display:block;margin-bottom:15px;}}/*!sc*/
.chSgxF li + li{margin-left:26px;}/*!sc*/
@media (max-width:920px){.chSgxF li + li{margin-left:0;}}/*!sc*/
.chSgxF a{display:inline-block;font-size:1.25rem;line-height:1;color:#000000;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.3s;transition:color 0.3s;}/*!sc*/
.chSgxF a:hover{color:#FE7A00;}/*!sc*/
@media (max-width:920px){.chSgxF a{padding:8px 0;}}/*!sc*/
data-styled.g10[id="sc-6852f5f6-3"]{content:"chSgxF,"}/*!sc*/
.hTbjmy{position:relative;width:160px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;margin-left:26px;}/*!sc*/
@media (max-width:920px){.hTbjmy{width:auto;margin-left:0;}}/*!sc*/
data-styled.g11[id="sc-6852f5f6-4"]{content:"hTbjmy,"}/*!sc*/
.kzOElI{display:inline-block;position:absolute;top:0;right:42px;width:calc(100% - 42px);height:100%;font-size:16px;line-height:1.25;padding:10px 13px;background:#fff;border-radius:5px 0px 0px 5px;border:1px solid #D9D9D9;border-right:none;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;}/*!sc*/
@media (max-width:920px){.kzOElI{display:none;}}/*!sc*/
.kzOElI::-webkit-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::-moz-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI:-ms-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::placeholder{color:#D9D9D9;}/*!sc*/
data-styled.g12[id="sc-6852f5f6-5"]{content:"kzOElI,"}/*!sc*/
.dSfmcG{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:#fff;margin-left:auto;-webkit-flex:0 0 42px;-ms-flex:0 0 42px;flex:0 0 42px;height:41px;border:1px solid #474747;border-radius:0px 5px 5px 0px;background-color:#474747;}/*!sc*/
@media (max-width:920px){.dSfmcG{margin-left:0;}}/*!sc*/
data-styled.g13[id="sc-6852f5f6-6"]{content:"dSfmcG,"}/*!sc*/
.eBQFeB{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
data-styled.g18[id="sc-da66f971-0"]{content:"eBQFeB,"}/*!sc*/
*,*:before,*:after{box-sizing:border-box;-webkit-font-smoothing:antialiased;}/*!sc*/
html,body{height:100%;margin:0;}/*!sc*/
html{font-family:'Source Sans Pro',sans-serif;font-weight:400;color:#000000;}/*!sc*/
body{background:#fff;}/*!sc*/
body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:normal;}/*!sc*/
main{padding-top:80px;-webkit-flex:1;-ms-flex:1;flex:1;}/*!sc*/
ol,ul{list-style:none;}/*!sc*/
figure{margin:0;}/*!sc*/
img,video{display:block;max-width:100%;height:auto;}/*!sc*/
a{color:unset;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
a:hover{color:unset;}/*!sc*/
strong{font-weight:600;}/*!sc*/
pre{display:block;padding:10px 14px;margin:0 0 10px;font-size:18px;line-height:1.42857143;word-break:break-all;word-wrap:break-word;color:#000;background-color:#f5f5f5;border-radius:5px;overflow-x:auto;word-wrap:normal;}/*!sc*/
pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0;}/*!sc*/
code{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;white-space:nowrap;border-radius:4px;white-space:pre-wrap;}/*!sc*/
::selection{background-color:#FE7A00;color:#fff;}/*!sc*/
.lg-container .lg-backdrop.in{opacity:0.75;}/*!sc*/
.lg-container .lg-toolbar.lg-group,.lg-container .lg-outer .lg-thumb-outer{background:rgba(0,0,0,0.45);}/*!sc*/
data-styled.g19[id="sc-global-gFJXlm1"]{content:"sc-global-gFJXlm1,"}/*!sc*/
.cXdfZy{font-size:62px;line-height:1.04;font-weight:700;color:#fff;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.cXdfZy{font-size:50px;}}/*!sc*/
@media (max-width:720px){.cXdfZy{font-size:42px;}}/*!sc*/
data-styled.g20[id="sc-4d34df46-0"]{content:"cXdfZy,"}/*!sc*/
.htQmXI h1{font-size:44px;line-height:1.13;font-weight:700;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h1{font-size:38px;}}/*!sc*/
@media (max-width:720px){.htQmXI h1{font-size:32px;}}/*!sc*/
.htQmXI h2{font-size:33px;line-height:1.13;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h2{font-size:30px;}}/*!sc*/
@media (max-width:720px){.htQmXI h2{font-size:26px;}}/*!sc*/
.htQmXI h3{font-size:28px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h3{font-size:26px;}}/*!sc*/
@media (max-width:720px){.htQmXI h3{font-size:24px;}}/*!sc*/
.htQmXI h4{font-size:22px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:720px){.htQmXI h4{font-size:20px;}}/*!sc*/
.htQmXI p{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI p{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI p{font-size:18px;}}/*!sc*/
.htQmXI ul,.htQmXI ol{padding-left:40px;}/*!sc*/
.htQmXI ul li,.htQmXI ol li{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI ul li,.htQmXI ol li{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI ul li,.htQmXI ol li{font-size:18px;}}/*!sc*/
.htQmXI ul li + li,.htQmXI ol li + li{margin-top:4px;}/*!sc*/
.htQmXI ul{list-style:disc;}/*!sc*/
.htQmXI ol{list-style:decimal;}/*!sc*/
.htQmXI p a,.htQmXI li a{color:#FE7A00;}/*!sc*/
.htQmXI p a:hover,.htQmXI li a:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.htQmXI * + *:not(li,a){margin-top:15px;}/*!sc*/
.htQmXI * + a[data-gallery],.htQmXI * + video{margin-top:40px;}/*!sc*/
.htQmXI a[data-gallery]{display:block;margin-bottom:40px;}/*!sc*/
.htQmXI iframe,.htQmXI video{margin-bottom:40px;}/*!sc*/
data-styled.g27[id="sc-b0f3732d-0"]{content:"htQmXI,"}/*!sc*/
.fdCCNC{display:block;margin-left:auto;margin-right:auto;}/*!sc*/
data-styled.g28[id="sc-b0f3732d-1"]{content:"fdCCNC,"}/*!sc*/
.jCTuUm{padding:80px 0;}/*!sc*/
@media (max-width:920px){.jCTuUm{padding:60px 0;}}/*!sc*/
@media (max-width:720px){.jCTuUm{padding:40px 0;}}/*!sc*/
data-styled.g30[id="sc-a3b7db7a-0"]{content:"jCTuUm,"}/*!sc*/
.kgITJj{margin-bottom:30px;}/*!sc*/
data-styled.g31[id="sc-a3b7db7a-1"]{content:"kgITJj,"}/*!sc*/
.gQoIni{position:relative;}/*!sc*/
data-styled.g32[id="sc-a3b7db7a-2"]{content:"gQoIni,"}/*!sc*/
.weLWi{position:absolute;top:0;right:100%;width:200px;margin-right:50px;text-align:right;}/*!sc*/
@media (max-width:1130px){.weLWi{position:unset;width:auto;text-align:left;margin:0 0 30px 0;}}/*!sc*/
data-styled.g33[id="sc-a3b7db7a-3"]{content:"weLWi,"}/*!sc*/
.insOoE{font-size:20px;line-height:1.25;color:#1F1F1F;text-transform:capitalize;color:#5651EC;}/*!sc*/
@media (max-width:920px){.insOoE{font-size:18px;}}/*!sc*/
.kakcer{font-size:20px;line-height:1.25;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.kakcer{font-size:18px;}}/*!sc*/
data-styled.g34[id="sc-a3b7db7a-4"]{content:"insOoE,kakcer,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-da66f971-0 eBQFeB __className_667be3"><nav class="sc-6852f5f6-0 gPgccM"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-6852f5f6-1 jrLPNu"><a href="/"><img alt="Orange Logo" loading="lazy" width="120" height="35" decoding="async" data-nimg="1" class="img-logo" style="color:transparent" src="/_next/static/media/logo-orange.faff1861.svg"/></a><div><button aria-label="Toggle navigation" class="sc-46d6b9d9-0 eWdALT"><div></div><div></div><div></div></button><div class="sc-6852f5f6-2 hzGhxs"><ul class="sc-6852f5f6-3 chSgxF"><li><a href="/examples">Examples</a></li><li><a href="/download">Download</a></li><li><a href="/blog">Blog</a></li><li><a href="/docs">Docs</a></li><li><a href="/workshops">Workshops</a></li></ul><form class="sc-6852f5f6-4 hTbjmy"><div class="sc-6852f5f6-5 kzOElI">Search</div><button class="sc-6852f5f6-6 dSfmcG"><img alt="Icon for search" loading="lazy" width="18" height="17" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/icon-search.459b2665.svg"/><span class="sc-cdea7863-0 jTcDmc">Search through page</span></button></form></div></div></div></div></nav><main><div class="sc-a3b7db7a-0 jCTuUm"><div class="sc-ef15f394-0 fJLXpS"><div class="sc-a3b7db7a-1 kgITJj"><p class="sc-a3b7db7a-4 insOoE"><strong>text mining, sentiment analysis, corpus, story arc, heat map, line chart</strong></p><h1 class="sc-4d34df46-0 cXdfZy">Detecting Story Arcs with Orange</h1></div><div class="sc-a3b7db7a-2 gQoIni"><div class="sc-a3b7db7a-3 weLWi"><p class="sc-a3b7db7a-4 kakcer"><strong>Ajda Pretnar</strong></p><p class="sc-a3b7db7a-4 kakcer">Jul 27, 2020</p></div><div class="sc-b0f3732d-0 htQmXI"><div class="lg-react-element "><p>Reading is fun because it takes you on a journey. Mostly, it is a journey of emotions as you live and breathe with the protagonist and her adventures. Today, we will have a look at how to detect sentiment in a story, plot story arcs and analyze the content of the key segments in a corpus.</p>
<p>Related: <a href="/blog/2018/09/11/text-workshops-in-ljubljana/" target="_blank" rel="noreferrer">Text Workshops in Ljubljana</a></p>
<p>We will be using a corpus of Anderson&#x27;s tales, which is available in the <strong>Corpus</strong> widget (data set <em>anderson.tab</em>). Load it in the widget. Next, we will select a single tale which we will analyze, say, Little Match Seller. Connect Corpus to <strong>Data Table</strong> and select the tale. We all know the story of a little girl selling matches on a New Year&#x27;s Eve and freezing to death. It is one of the saddest stories ever told. One could almost forget there are positive parts, such as the girl&#x27;s visions in the moments before her death, which show a glimmer of hope, the only consolation the girl had in her life. Let us verify this in Orange.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-corpus.webp" data-gallery="true"><img alt="" loading="lazy" width="454" height="336" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-corpus.webp"/></a>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-data-table.webp" data-gallery="true"><img alt="" loading="lazy" width="513" height="192" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-data-table.webp"/></a>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf1.webp" data-gallery="true"><img alt="" loading="lazy" width="246" height="98" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf1.webp"/></a>
<p>With our story selected, we have to split it into sentences. At the moment, our story is a single row in the data, but we wish to have each sentence in its own row. We will use <strong>Preprocess Text</strong> and select Sentence tokenization. I have removed the redundant preprocessors and kept the only one we need.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess.webp" data-gallery="true"><img alt="" loading="lazy" width="569" height="526" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess.webp"/></a>
<p>Some Python magic will help us create a new corpus from the existing tokens (sentences). Copy and paste the script below into the <strong>Python Script</strong> widget. Do not forget to press <strong>Run</strong> once you have pasted the script into the widget.</p>
<pre><code>    import numpy as np
    from Orange.data import Domain, StringVariable
    from orangecontrib.text.corpus import Corpus

    tokens = in_data.tokens
    new_domain = Domain(attributes=[], metas=[StringVariable(&#x27;Sentences&#x27;), StringVariable(&#x27;Title&#x27;)])

    titles = []
    content = []

    for i, doc in enumerate(tokens):
        for t in doc:
            titles.append(in_data[i][&#x27;Title&#x27;].value)
            content.append(t)

    metas = np.column_stack((content, titles))
    out_data = Corpus.from_numpy(domain=new_domain, X=np.empty((len(content), 0)),
                                metas=metas)
    out_data.set_text_features([StringVariable(&#x27;Sentences&#x27;)])
</code></pre>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf2.webp" data-gallery="true"><img alt="" loading="lazy" width="556" height="109" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf2.webp"/></a>
<p>Perfect, our data is now ready for the final step. Add another Preprocess Text and keep the default preprocessors. They will lowercase our sentences, split by words and remove English stopwords.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess2.webp" data-gallery="true"><img alt="" loading="lazy" width="735" height="571" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess2.webp"/></a>
<p>Finally, add the <strong>Sentiment Analysis</strong> widget. By default, the widget uses the Vader algorithm, which works quite well for English. Please note that it won&#x27;t work for other languages, as all of Orange&#x27;s sentiment models are language specific. You can use Multilingual sentiment for non-English texts.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-sentiment-analysis.webp" data-gallery="true"><img alt="" loading="lazy" width="402" height="249" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-sentiment-analysis.webp"/></a>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf3.webp" data-gallery="true"><img alt="" loading="lazy" width="853" height="110" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf3.webp"/></a>
<p>At last, it is time to analyze the data. We will use <a href="https://github.com/biolab/orange3-timeseries">Timeseries add-on</a> to plot sequential data. First, we will pass the data to the <strong>As Timeseries</strong> widget and set the <em>Sequence implied by the instance order</em> option. This tells Orange that our data is already ordered by time - in our case, by the order in which each sentence appears in the story.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-as-timeseries.webp" data-gallery="true"><img alt="" loading="lazy" width="297" height="225" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-as-timeseries.webp"/></a>
<p>Connect <strong>Line Chart</strong> to As Timeseries. In the widget, select <em>Compound</em> variable, which shows the total sentiment of each sentence. The peaks represent the parts of the story with positive emotions and the drops the parts with the negative ones.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-line-chart.webp" data-gallery="true"><img alt="" loading="lazy" width="891" height="327" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-line-chart.webp"/></a>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf4.webp" data-gallery="true"><img alt="" loading="lazy" width="574" height="107" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf4.webp"/></a>
<p>To explore the data in depth, connect <strong>Heat Map</strong> to Sentiment Analysis. Heat Map will show all 4 sentiment attributes, namely positive (pos), negative (neg), neutral (neu) and   compound sentiment. But our data is all over the place. Let us order it. Select <em>Clustering (opt. ordering)</em> under the Clustering - Rows option. This will cluster the sentences by their similarity, specifically by how similar their emotion is.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-heat-map.webp" data-gallery="true"><img alt="" loading="lazy" width="569" height="757" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-heat-map.webp"/></a>
<p>Great! Now this looks like something useful. The blue sections represent the negative sentences, while the yellow and white sections represent the positive ones. Let us select the cluster with negative sentences and observe it in a <strong>Corpus Viewer</strong>.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-negative-sentiment.webp" data-gallery="true"><img alt="" loading="lazy" width="733" height="635" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-negative-sentiment.webp"/></a>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf5.webp" data-gallery="true"><img alt="" loading="lazy" width="423" height="205" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf5.webp"/></a>
<p>I have set Sentences as the single Display variable and selected all the sentences to show them in a list. Unsurprisingly, here is the last sentence of the story, in which a girl if found dead in the street on a New Year&#x27;s Day.</p>
<p>To finish, let us explore the positive sentences, too. Select the positive section in the Heat Map and observe it in a Corpus Viewer. Now rethink the story, reread her visions in the last moments of her life and how happy she was when she died. Couldn&#x27;t we say that ... the story has a happy ending?</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-positive-sentiment.webp" data-gallery="true"><img alt="" loading="lazy" width="733" height="635" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-positive-sentiment.webp"/></a>
<p>While the workflow is quite long, it is conceptually very simple. This is a quick and easy way to explore the story arcs and sentiment in a text. We imagine this to be a very useful tool for the teachers who wish to experiment a bit in their language classes and offer a fun and fruitful way of exploring literature.</p>
<a href="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-final-workflow.webp" data-gallery="true"><img alt="" loading="lazy" width="2306" height="440" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2020-07-story-arcs/__webp-images__/2020-07-27-final-workflow.webp"/></a></div></div></div></div></div></main><footer class="sc-c82ca4e2-0 iQtqNS"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-c82ca4e2-1 iiCJUO"><div><h3>Orange</h3><ul><li><a href="/faq">FAQ</a></li><li><a href="/license">License</a></li><li><a href="/privacy">Privacy</a></li><li><a href="/citation">Citation</a></li><li><a href="/contact">Contact</a></li></ul></div><div><h3>Download</h3><ul><li><a href="/download#win">Windows</a></li><li><a href="/download#mac">Mac OS</a></li></ul></div><div><h3>Community</h3><ul><li><a href="https://twitter.com/OrangeDataMiner">Twitter</a></li><li><a href="https://www.facebook.com/orangedatamining">Facebook</a></li><li><a href="https://datascience.stackexchange.com/questions/tagged/orange">Stack Exchange</a></li><li><a href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g">YouTube</a></li><li><a href="https://discord.com/invite/FWrfeXV">Discord</a></li></ul></div><div><h3>Documentation</h3><ul><li><a href="/getting-started">Get started</a></li><li><a href="/widget-catalogue">Widgets</a></li><li><a href="https://orange3.readthedocs.io/projects/orange-data-mining-library/en/latest/">Scripting</a></li></ul></div><div><h3>Developers</h3><ul><li><a href="https://github.com/biolab/orange3">GitHub</a></li><li><a href="http://docs.biolab.si/3/development/">Getting started</a></li></ul></div><div><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J" target="_blank" rel="noreferrer" class="sc-b6ea565a-0 jyxOJT">Donate to Orange</a></div></div><p>Copyright © University of Ljubljana</p></div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontmatter":{"author":"Ajda Pretnar","date":"2020-07-27","draft":false,"title":"Detecting Story Arcs with Orange","thumbImage":"2020-07-27-story-arcs-small.png","frontPageImage":"2020-07-27-story-arcs-small.png","blog":["text mining","sentiment analysis","corpus","story arc","heat map","line chart"],"shortExcerpt":"How to detect and analyze story arcs in a corpus.","longExcerpt":"How to detect sentiment, plot story arcs and analyze the key segments in a corpus.","x2images":false,"aliases":["/blog/2021/2021-04-16-story-arcs/"],"oldUrl":"/blog/2020/2020-07-27-story-arcs/"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    strong: \"strong\",\n    em: \"em\",\n    pre: \"pre\",\n    code: \"code\",\n    a: \"a\"\n  }, _provideComponents(), props.components), {LinkNew, WindowScreenshot, WorkflowScreenshot} = _components;\n  if (!LinkNew) _missingMdxReference(\"LinkNew\", true);\n  if (!WindowScreenshot) _missingMdxReference(\"WindowScreenshot\", true);\n  if (!WorkflowScreenshot) _missingMdxReference(\"WorkflowScreenshot\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Reading is fun because it takes you on a journey. Mostly, it is a journey of emotions as you live and breathe with the protagonist and her adventures. Today, we will have a look at how to detect sentiment in a story, plot story arcs and analyze the content of the key segments in a corpus.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Related: \", _jsx(LinkNew, {\n        url: \"/blog/2018/09/11/text-workshops-in-ljubljana/\",\n        name: \"Text Workshops in Ljubljana\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We will be using a corpus of Anderson's tales, which is available in the \", _jsx(_components.strong, {\n        children: \"Corpus\"\n      }), \" widget (data set \", _jsx(_components.em, {\n        children: \"anderson.tab\"\n      }), \"). Load it in the widget. Next, we will select a single tale which we will analyze, say, Little Match Seller. Connect Corpus to \", _jsx(_components.strong, {\n        children: \"Data Table\"\n      }), \" and select the tale. We all know the story of a little girl selling matches on a New Year's Eve and freezing to death. It is one of the saddest stories ever told. One could almost forget there are positive parts, such as the girl's visions in the moments before her death, which show a glimmer of hope, the only consolation the girl had in her life. Let us verify this in Orange.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-corpus.png\",\n      width: \"454\",\n      height: \"336\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-corpus.webp\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-data-table.png\",\n      width: \"513\",\n      height: \"192\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-data-table.webp\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-wf1.png\",\n      width: \"246\",\n      height: \"98\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf1.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"With our story selected, we have to split it into sentences. At the moment, our story is a single row in the data, but we wish to have each sentence in its own row. We will use \", _jsx(_components.strong, {\n        children: \"Preprocess Text\"\n      }), \" and select Sentence tokenization. I have removed the redundant preprocessors and kept the only one we need.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-preprocess.png\",\n      width: \"569\",\n      height: \"526\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Some Python magic will help us create a new corpus from the existing tokens (sentences). Copy and paste the script below into the \", _jsx(_components.strong, {\n        children: \"Python Script\"\n      }), \" widget. Do not forget to press \", _jsx(_components.strong, {\n        children: \"Run\"\n      }), \" once you have pasted the script into the widget.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"    import numpy as np\\n    from Orange.data import Domain, StringVariable\\n    from orangecontrib.text.corpus import Corpus\\n\\n    tokens = in_data.tokens\\n    new_domain = Domain(attributes=[], metas=[StringVariable('Sentences'), StringVariable('Title')])\\n\\n    titles = []\\n    content = []\\n\\n    for i, doc in enumerate(tokens):\\n        for t in doc:\\n            titles.append(in_data[i]['Title'].value)\\n            content.append(t)\\n\\n    metas = np.column_stack((content, titles))\\n    out_data = Corpus.from_numpy(domain=new_domain, X=np.empty((len(content), 0)),\\n                                metas=metas)\\n    out_data.set_text_features([StringVariable('Sentences')])\\n\"\n      })\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-wf2.png\",\n      width: \"556\",\n      height: \"109\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf2.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Perfect, our data is now ready for the final step. Add another Preprocess Text and keep the default preprocessors. They will lowercase our sentences, split by words and remove English stopwords.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-preprocess2.png\",\n      width: \"735\",\n      height: \"571\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-preprocess2.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Finally, add the \", _jsx(_components.strong, {\n        children: \"Sentiment Analysis\"\n      }), \" widget. By default, the widget uses the Vader algorithm, which works quite well for English. Please note that it won't work for other languages, as all of Orange's sentiment models are language specific. You can use Multilingual sentiment for non-English texts.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-sentiment-analysis.png\",\n      width: \"402\",\n      height: \"249\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-sentiment-analysis.webp\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-wf3.png\",\n      width: \"853\",\n      height: \"110\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf3.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"At last, it is time to analyze the data. We will use \", _jsx(_components.a, {\n        href: \"https://github.com/biolab/orange3-timeseries\",\n        children: \"Timeseries add-on\"\n      }), \" to plot sequential data. First, we will pass the data to the \", _jsx(_components.strong, {\n        children: \"As Timeseries\"\n      }), \" widget and set the \", _jsx(_components.em, {\n        children: \"Sequence implied by the instance order\"\n      }), \" option. This tells Orange that our data is already ordered by time - in our case, by the order in which each sentence appears in the story.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-as-timeseries.png\",\n      width: \"297\",\n      height: \"225\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-as-timeseries.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Connect \", _jsx(_components.strong, {\n        children: \"Line Chart\"\n      }), \" to As Timeseries. In the widget, select \", _jsx(_components.em, {\n        children: \"Compound\"\n      }), \" variable, which shows the total sentiment of each sentence. The peaks represent the parts of the story with positive emotions and the drops the parts with the negative ones.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-line-chart.png\",\n      width: \"891\",\n      height: \"327\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-line-chart.webp\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-wf4.png\",\n      width: \"574\",\n      height: \"107\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf4.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To explore the data in depth, connect \", _jsx(_components.strong, {\n        children: \"Heat Map\"\n      }), \" to Sentiment Analysis. Heat Map will show all 4 sentiment attributes, namely positive (pos), negative (neg), neutral (neu) and   compound sentiment. But our data is all over the place. Let us order it. Select \", _jsx(_components.em, {\n        children: \"Clustering (opt. ordering)\"\n      }), \" under the Clustering - Rows option. This will cluster the sentences by their similarity, specifically by how similar their emotion is.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-heat-map.png\",\n      width: \"569\",\n      height: \"757\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-heat-map.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Great! Now this looks like something useful. The blue sections represent the negative sentences, while the yellow and white sections represent the positive ones. Let us select the cluster with negative sentences and observe it in a \", _jsx(_components.strong, {\n        children: \"Corpus Viewer\"\n      }), \".\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-negative-sentiment.png\",\n      width: \"733\",\n      height: \"635\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-negative-sentiment.webp\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-wf5.png\",\n      width: \"423\",\n      height: \"205\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-wf5.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I have set Sentences as the single Display variable and selected all the sentences to show them in a list. Unsurprisingly, here is the last sentence of the story, in which a girl if found dead in the street on a New Year's Day.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To finish, let us explore the positive sentences, too. Select the positive section in the Heat Map and observe it in a Corpus Viewer. Now rethink the story, reread her visions in the last moments of her life and how happy she was when she died. Couldn't we say that ... the story has a happy ending?\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-positive-sentiment.png\",\n      width: \"733\",\n      height: \"635\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-positive-sentiment.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"While the workflow is quite long, it is conceptually very simple. This is a quick and easy way to explore the story arcs and sentiment in a text. We imagine this to be a very useful tool for the teachers who wish to experiment a bit in their language classes and offer a fun and fruitful way of exploring literature.\"\n    }), \"\\n\", _jsx(WorkflowScreenshot, {\n      src: \"/blog/2020-07-story-arcs/2020-07-27-final-workflow.png\",\n      width: \"2306\",\n      height: \"440\",\n      src: \"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-final-workflow.webp\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}},"thumbImage":{"width":599,"height":400,"src":"/blog/2020-07-story-arcs/__webp-images__/2020-07-27-story-arcs-small.webp"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"detecting-story-arcs-with-orange"},"buildId":"hMev--kvhv30RuWEFrRTZ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>