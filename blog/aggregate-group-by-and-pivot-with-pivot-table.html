<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>My new cool app</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/4ac7ed34d61ef456.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4ac7ed34d61ef456.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d38be8d96a62f950.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-9f90a364d66949ce.js" defer=""></script><script src="/_next/static/chunks/pages/_app-35144eb61b09af2c.js" defer=""></script><script src="/_next/static/chunks/675-262430aa11afdf01.js" defer=""></script><script src="/_next/static/chunks/9-9d15d34c7affe00b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-fd50a1465d8f452c.js" defer=""></script><script src="/_next/static/Z00IbhcMESsGP8msRS_H6/_buildManifest.js" defer=""></script><script src="/_next/static/Z00IbhcMESsGP8msRS_H6/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.6">.iBQlkL{background:coral;height:60px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.iBQlkL ul{display:none;}}/*!sc*/
data-styled.g1[id="sc-7295e4c-0"]{content:"iBQlkL,"}/*!sc*/
.bDMZDz{display:none;font-size:22px;margin-left:auto;}/*!sc*/
@media (max-width:920px){.bDMZDz{display:block;}}/*!sc*/
data-styled.g2[id="sc-7295e4c-1"]{content:"bDMZDz,"}/*!sc*/
html,body{height:100%;margin:0;}/*!sc*/
body{background:#fff;}/*!sc*/
html{box-sizing:border-box;font-size:16px;}/*!sc*/
*,*:before,*:after{box-sizing:inherit;}/*!sc*/
body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:normal;}/*!sc*/
ol,ul{list-style:none;}/*!sc*/
img,video{max-width:100%;height:auto;}/*!sc*/
.lg-container .lg-backdrop.in{opacity:0.75;}/*!sc*/
.lg-container .lg-toolbar.lg-group,.lg-container .lg-outer .lg-thumb-outer{background:rgba(0,0,0,0.45);}/*!sc*/
data-styled.g3[id="sc-global-cqyaiF1"]{content:"sc-global-cqyaiF1,"}/*!sc*/
.gndEvh{max-width:800px;margin:0 auto;}/*!sc*/
data-styled.g6[id="sc-6329e001-0"]{content:"gndEvh,"}/*!sc*/
</style></head><body><div id="__next"><nav class="sc-7295e4c-0 iBQlkL"><ul><a href="/blog">Blog</a></ul><button class="sc-7295e4c-1 bDMZDz">X</button></nav><main><div class="sc-6329e001-0 gndEvh"><h1>Aggregate, Group By and Pivot with... Pivot Table!</h1><div class="lg-react-element "><p>Orange recently welcomed its new Pivot Table widget, which offers functionalities for data aggregation, grouping and, well, pivot tables. The widget is a one-stop-shop for pandas&#x27; aggregate, groupby and pivot_table functions.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_workflow.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_workflow.png 1x, /blog/2019-08-pivot-table/2019-08-27_workflow.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_workflow.png" width="538" height="356" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<p>Let us see how to achieve these tasks in Orange. For all of the below examples we will be using the <em>heart_disease.tab</em> data.</p>
<h2>pandas.DataFrame.agg</h2>
<p>The first task is computing a simple mean for the column <em>age</em>.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.aggregate.html">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt;df[&#x27;age&#x27;].agg(&#x27;mean&#x27;)
54.43894389438944
</code></pre>
<p>In Orange:</p>
<p>In <strong>Pivot Table</strong> we set <em>Values</em> to <em>age</em> and set aggregations to <em>mean</em>. There is no way to turn off splitting by rows in Pivot Table, but the values in Total report the mean value for the chosen attribute.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_pivot-aggregate.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_pivot-aggregate.png 1x, /blog/2019-08-pivot-table/2019-08-27_pivot-aggregate.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_pivot-aggregate.png" width="670" height="525" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<p>An even better way to observe simple statistics is in <strong>Feature Statistics</strong> widget. The widget also reports on the mean value of each attribute with handy distributions plots included.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_feature-statistics.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_feature-statistics.png 1x, /blog/2019-08-pivot-table/2019-08-27_feature-statistics.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_feature-statistics.png" width="1037" height="349" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<p>Yet another way to observe a mean value is in a <strong>Box Plot</strong>.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_box-plot.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_box-plot.png 1x, /blog/2019-08-pivot-table/2019-08-27_box-plot.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_box-plot.png" width="827" height="437" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<h2>pandas.DataFrame.groupby</h2>
<p>The second task is grouping the data by a discrete column. Say we want to group by gender and report the mean value for each column.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt; df.groupby([&#x27;gender&#x27;]).mean()
              age    rest SBP   ...  ST by exer.  major ves. col.  diameter narrowing
gender
female  55.721649  133.340206   ...   0.867010    0.546392          0.257732
male    53.834951  130.912621   ...   1.120874    0.732673          0.553398

[2 rows x 9 columns]
</code></pre>
<p>In Orange:</p>
<p>In <strong>Pivot Table</strong> set <em>Rows</em> to <em>gender</em> and aggregation method to <em>mean</em>. The <em>Values</em> option in this example has no effect. Now, connect <strong>Data Table</strong> to Pivot Table. Finally, reset the connections. Pivot Table outputs three types of data - Pivot Table, Filtered Data, and Grouped Data. The output we are looking for here is <em>Grouped Data</em>.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_edit-links.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_edit-links.png 1x, /blog/2019-08-pivot-table/2019-08-27_edit-links.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_edit-links.png" width="561" height="280" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<a href="/blog/2019-08-pivot-table/2019-08-27_pivot-groupby.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_pivot-groupby.png 1x, /blog/2019-08-pivot-table/2019-08-27_pivot-groupby.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_pivot-groupby.png" width="558" height="525" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<p>This is our data table. Exactly what we were looking for.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_groupby-data-table.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_groupby-data-table.png 1x, /blog/2019-08-pivot-table/2019-08-27_groupby-data-table.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_groupby-data-table.png" width="755" height="193" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<h2>pandas.DataFrame.pivot_table</h2>
<p>The third, final task is constructing a pivot table where rows are values of <em>diameter narrowing</em>, columns are values of <em>gender</em> and the values in cells is the mean of <em>age</em> for each subgroup. In other words, we want to see the average age of females with diameter narrowing, males with diameter narrowing, females without diameter narrowing and males without diameter narrowing.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html#pandas.DataFrame.pivot_table">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt; pd.pivot_table(df, values=&#x27;age&#x27;, index=[&#x27;diameter narrowing&#x27;], columns=[&#x27;gender&#x27;], aggfunc=np.mean)
gender                 female       male
diameter narrowing
0                   54.555556  51.043478
1                   59.080000  56.087719
</code></pre>
<p>In Orange:</p>
<p>In <strong>Pivot Table</strong> set <em>Rows</em> to <em>diameter narrowing</em>, <em>Columns</em> to <em>gender</em>, <em>Values</em> to <em>age</em> and aggregation method to <em>mean</em>. The widget already offers a view of the final data table, but we can also output it and use it in other Orange widgets.</p>
<a href="/blog/2019-08-pivot-table/2019-08-27_pivot-table.png" data-gallery="true"><img srcSet="/blog/2019-08-pivot-table/2019-08-27_pivot-table.png 1x, /blog/2019-08-pivot-table/2019-08-27_pivot-table.png 2x" src="/blog/2019-08-pivot-table/2019-08-27_pivot-table.png" width="569" height="525" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>
<p><strong>Pivot Table</strong> widget really versatile - like a Swiss knife for data transformation.</p></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"author":"Ajda Pretnar","date":"2019-08-27","draft":false,"title":"Aggregate, Group By and Pivot with... Pivot Table!","type":"blog","thumbImage":"2019-08-27_pivot-preview.png","frontPageImage":"2019-08-27_pivot-preview.png","blog":["pivot table","aggregate","data","groupby"],"shortExcerpt":"Orange's brand new Pivot Table widget with many aggregation and grouping functionalities.","longExcerpt":"Orange has a brand new Pivot Table widget with many aggregation and grouping functionalities. It can be used to transform the data on-the-fly and use the output for downstream analysis."},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    em: \"em\",\n    h2: \"h2\",\n    a: \"a\",\n    pre: \"pre\",\n    code: \"code\",\n    strong: \"strong\"\n  }, _provideComponents(), props.components), {Figure} = _components;\n  if (!Figure) _missingMdxReference(\"Figure\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Orange recently welcomed its new Pivot Table widget, which offers functionalities for data aggregation, grouping and, well, pivot tables. The widget is a one-stop-shop for pandas' aggregate, groupby and pivot_table functions.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_workflow.png\",\n      caption: \"\",\n      width: \"538\",\n      height: \"356\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let us see how to achieve these tasks in Orange. For all of the below examples we will be using the \", _jsx(_components.em, {\n        children: \"heart_disease.tab\"\n      }), \" data.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"pandas.DataFrame.agg\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The first task is computing a simple mean for the column \", _jsx(_components.em, {\n        children: \"age\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.aggregate.html\",\n        children: \"In pandas\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"\u003e\u003e\u003edf['age'].agg('mean')\\n54.43894389438944\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In Orange:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In \", _jsx(_components.strong, {\n        children: \"Pivot Table\"\n      }), \" we set \", _jsx(_components.em, {\n        children: \"Values\"\n      }), \" to \", _jsx(_components.em, {\n        children: \"age\"\n      }), \" and set aggregations to \", _jsx(_components.em, {\n        children: \"mean\"\n      }), \". There is no way to turn off splitting by rows in Pivot Table, but the values in Total report the mean value for the chosen attribute.\"]\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_pivot-aggregate.png\",\n      caption: \"\",\n      width: \"670\",\n      height: \"525\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"An even better way to observe simple statistics is in \", _jsx(_components.strong, {\n        children: \"Feature Statistics\"\n      }), \" widget. The widget also reports on the mean value of each attribute with handy distributions plots included.\"]\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_feature-statistics.png\",\n      caption: \"\",\n      width: \"1037\",\n      height: \"349\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Yet another way to observe a mean value is in a \", _jsx(_components.strong, {\n        children: \"Box Plot\"\n      }), \".\"]\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_box-plot.png\",\n      caption: \"\",\n      width: \"827\",\n      height: \"437\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"pandas.DataFrame.groupby\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The second task is grouping the data by a discrete column. Say we want to group by gender and report the mean value for each column.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html\",\n        children: \"In pandas\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"\u003e\u003e\u003e df.groupby(['gender']).mean()\\n              age    rest SBP   ...  ST by exer.  major ves. col.  diameter narrowing\\ngender\\nfemale  55.721649  133.340206   ...   0.867010    0.546392          0.257732\\nmale    53.834951  130.912621   ...   1.120874    0.732673          0.553398\\n\\n[2 rows x 9 columns]\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In Orange:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In \", _jsx(_components.strong, {\n        children: \"Pivot Table\"\n      }), \" set \", _jsx(_components.em, {\n        children: \"Rows\"\n      }), \" to \", _jsx(_components.em, {\n        children: \"gender\"\n      }), \" and aggregation method to \", _jsx(_components.em, {\n        children: \"mean\"\n      }), \". The \", _jsx(_components.em, {\n        children: \"Values\"\n      }), \" option in this example has no effect. Now, connect \", _jsx(_components.strong, {\n        children: \"Data Table\"\n      }), \" to Pivot Table. Finally, reset the connections. Pivot Table outputs three types of data - Pivot Table, Filtered Data, and Grouped Data. The output we are looking for here is \", _jsx(_components.em, {\n        children: \"Grouped Data\"\n      }), \".\"]\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_edit-links.png\",\n      caption: \"\",\n      width: \"561\",\n      height: \"280\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_pivot-groupby.png\",\n      caption: \"\",\n      width: \"558\",\n      height: \"525\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This is our data table. Exactly what we were looking for.\"\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_groupby-data-table.png\",\n      caption: \"\",\n      width: \"755\",\n      height: \"193\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"pandas.DataFrame.pivot_table\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The third, final task is constructing a pivot table where rows are values of \", _jsx(_components.em, {\n        children: \"diameter narrowing\"\n      }), \", columns are values of \", _jsx(_components.em, {\n        children: \"gender\"\n      }), \" and the values in cells is the mean of \", _jsx(_components.em, {\n        children: \"age\"\n      }), \" for each subgroup. In other words, we want to see the average age of females with diameter narrowing, males with diameter narrowing, females without diameter narrowing and males without diameter narrowing.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html#pandas.DataFrame.pivot_table\",\n        children: \"In pandas\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"\u003e\u003e\u003e pd.pivot_table(df, values='age', index=['diameter narrowing'], columns=['gender'], aggfunc=np.mean)\\ngender                 female       male\\ndiameter narrowing\\n0                   54.555556  51.043478\\n1                   59.080000  56.087719\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In Orange:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In \", _jsx(_components.strong, {\n        children: \"Pivot Table\"\n      }), \" set \", _jsx(_components.em, {\n        children: \"Rows\"\n      }), \" to \", _jsx(_components.em, {\n        children: \"diameter narrowing\"\n      }), \", \", _jsx(_components.em, {\n        children: \"Columns\"\n      }), \" to \", _jsx(_components.em, {\n        children: \"gender\"\n      }), \", \", _jsx(_components.em, {\n        children: \"Values\"\n      }), \" to \", _jsx(_components.em, {\n        children: \"age\"\n      }), \" and aggregation method to \", _jsx(_components.em, {\n        children: \"mean\"\n      }), \". The widget already offers a view of the final data table, but we can also output it and use it in other Orange widgets.\"]\n    }), \"\\n\", _jsx(Figure, {\n      src: \"/blog/2019-08-pivot-table/2019-08-27_pivot-table.png\",\n      caption: \"\",\n      width: \"569\",\n      height: \"525\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Pivot Table\"\n      }), \" widget really versatile - like a Swiss knife for data transformation.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"aggregate-group-by-and-pivot-with-pivot-table"},"buildId":"Z00IbhcMESsGP8msRS_H6","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>