<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Orange Data Mining</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/media/0ac14a3c407fb3c4-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/fc6fba7ce0876fef-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/3cc61a2a1d48cb85-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/b49f75c2c957040b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b49f75c2c957040b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/4ac7ed34d61ef456.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4ac7ed34d61ef456.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-880e48e2fc817058.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-321f842b3cd96ae0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4ef7cce9efc20c09.js" defer=""></script><script src="/_next/static/chunks/815-30d73934dc079aab.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-317e2716681b8fa3.js" defer=""></script><script src="/_next/static/lhloBTgr-gRDgL8UrpHOm/_buildManifest.js" defer=""></script><script src="/_next/static/lhloBTgr-gRDgL8UrpHOm/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.6">.iSNtvJ{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;}/*!sc*/
@media (max-width:1130px){.iSNtvJ{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.iSNtvJ{padding-left:15px;padding-right:15px;}}/*!sc*/
.fJLXpS{position:relative;max-width:1296px;margin-right:auto;margin-left:auto;padding-left:72px;padding-right:72px;height:100%;box-sizing:content-box;max-width:714px;}/*!sc*/
@media (max-width:1130px){.fJLXpS{padding-left:30px;padding-right:30px;}}/*!sc*/
@media (max-width:720px){.fJLXpS{padding-left:15px;padding-right:15px;}}/*!sc*/
data-styled.g1[id="sc-ef15f394-0"]{content:"iSNtvJ,fJLXpS,"}/*!sc*/
.fYoBKL{position:relative;display:inline-block;max-width:100%;font-size:20px;line-height:1.25;font-weight:600;-webkit-text-decoration:none;text-decoration:none;color:#fff;padding:10px 15px;border-radius:5px;background-image:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);background-size:100%;cursor:pointer;z-index:2;}/*!sc*/
.fYoBKL:before{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;background-image:linear-gradient(180deg,#ffbc44 100%,#FE7A00 100%);opacity:0;z-index:-100;-webkit-transition:opacity 0.45s;transition:opacity 0.45s;}/*!sc*/
.fYoBKL:hover{color:#fff;}/*!sc*/
.fYoBKL:hover:before{opacity:1;}/*!sc*/
data-styled.g2[id="sc-e429b959-0"]{content:"fYoBKL,"}/*!sc*/
.ikuqzB{background:#1F1F1F;padding:38px 0 25px;color:#fff;}/*!sc*/
data-styled.g3[id="sc-7afe78da-0"]{content:"ikuqzB,"}/*!sc*/
.hrSlzr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-column-gap:80px;column-gap:80px;row-gap:40px;margin-bottom:40px;}/*!sc*/
.hrSlzr h3{font-size:16px;font-weight:600;margin-bottom:12px;}/*!sc*/
.hrSlzr li + li{margin-top:12px;}/*!sc*/
data-styled.g4[id="sc-7afe78da-1"]{content:"hrSlzr,"}/*!sc*/
.eWdALT{display:none;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:44px;height:34px;padding:6px;border-radius:5px;border:none;background:linear-gradient(180deg,#FE7A00 74.93%,#F65D18 100%);box-shadow:0px 10px 10px rgba(0,0,0,0.03);cursor:pointer;margin-left:auto;}/*!sc*/
@media (max-width:920px){.eWdALT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
.eWdALT div{width:22px;height:2px;background:#fff;-webkit-transform-origin:1px;-ms-transform-origin:1px;transform-origin:1px;-webkit-transition:all 0.3s linear;transition:all 0.3s linear;}/*!sc*/
data-styled.g5[id="sc-46d6b9d9-0"]{content:"eWdALT,"}/*!sc*/
.jTcDmc{-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;}/*!sc*/
data-styled.g6[id="sc-cdea7863-0"]{content:"jTcDmc,"}/*!sc*/
.gPgccM{position:fixed;top:0;left:0;width:100%;height:80px;z-index:5;background:#fff;box-shadow:0px 4px 10px 4px rgba(0,0,0,0.04);}/*!sc*/
data-styled.g7[id="sc-6852f5f6-0"]{content:"gPgccM,"}/*!sc*/
.jrLPNu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}/*!sc*/
.jrLPNu .img-logo{width:115px;}/*!sc*/
data-styled.g8[id="sc-6852f5f6-1"]{content:"jrLPNu,"}/*!sc*/
.hzGhxs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.hzGhxs{display:block;position:absolute;top:80px;left:0;width:100%;z-index:1;padding:0 30px 30px;background-color:#fff;opacity:0;z-index:-9999;pointer-events:none;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;box-shadow:0 4px 10px -1px rgba(0,0,0,0.04);}}/*!sc*/
@media (max-width:720px){.hzGhxs{padding:0 15px 15px;}}/*!sc*/
data-styled.g9[id="sc-6852f5f6-2"]{content:"hzGhxs,"}/*!sc*/
.chSgxF{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (max-width:920px){.chSgxF{display:block;margin-bottom:15px;}}/*!sc*/
.chSgxF li + li{margin-left:26px;}/*!sc*/
@media (max-width:920px){.chSgxF li + li{margin-left:0;}}/*!sc*/
.chSgxF a{display:inline-block;font-size:1.25rem;line-height:1;color:#000000;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.3s;transition:color 0.3s;}/*!sc*/
.chSgxF a:hover{color:#FE7A00;}/*!sc*/
@media (max-width:920px){.chSgxF a{padding:8px 0;}}/*!sc*/
data-styled.g10[id="sc-6852f5f6-3"]{content:"chSgxF,"}/*!sc*/
.hTbjmy{position:relative;width:160px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;margin-left:26px;}/*!sc*/
@media (max-width:920px){.hTbjmy{width:auto;margin-left:0;}}/*!sc*/
data-styled.g11[id="sc-6852f5f6-4"]{content:"hTbjmy,"}/*!sc*/
.kzOElI{display:inline-block;position:absolute;top:0;right:42px;width:calc(100% - 42px);height:100%;font-size:16px;line-height:1.25;padding:10px 13px;background:#fff;border-radius:5px 0px 0px 5px;border:1px solid #D9D9D9;border-right:none;-webkit-transition:width 0.3s ease-in-out;transition:width 0.3s ease-in-out;}/*!sc*/
@media (max-width:920px){.kzOElI{display:none;}}/*!sc*/
.kzOElI::-webkit-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::-moz-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI:-ms-input-placeholder{color:#D9D9D9;}/*!sc*/
.kzOElI::placeholder{color:#D9D9D9;}/*!sc*/
data-styled.g12[id="sc-6852f5f6-5"]{content:"kzOElI,"}/*!sc*/
.dSfmcG{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:#fff;margin-left:auto;-webkit-flex:0 0 42px;-ms-flex:0 0 42px;flex:0 0 42px;height:41px;border:1px solid #474747;border-radius:0px 5px 5px 0px;background-color:#474747;}/*!sc*/
@media (max-width:920px){.dSfmcG{margin-left:0;}}/*!sc*/
data-styled.g13[id="sc-6852f5f6-6"]{content:"dSfmcG,"}/*!sc*/
*,*:before,*:after{box-sizing:border-box;-webkit-font-smoothing:antialiased;}/*!sc*/
html,body{height:100%;margin:0;}/*!sc*/
html{font-family:'Source Sans Pro',sans-serif;font-weight:400;color:#000000;}/*!sc*/
body{background:#fff;}/*!sc*/
body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:normal;}/*!sc*/
main{padding-top:80px;}/*!sc*/
ol,ul{list-style:none;}/*!sc*/
figure{margin:0;}/*!sc*/
img,video{display:block;max-width:100%;height:auto;}/*!sc*/
a{color:unset;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
a:hover{color:unset;}/*!sc*/
strong{font-weight:600;}/*!sc*/
pre{display:block;padding:10px 14px;margin:0 0 10px;font-size:18px;line-height:1.42857143;word-break:break-all;word-wrap:break-word;color:#000;background-color:#f5f5f5;border-radius:5px;overflow-x:auto;word-wrap:normal;}/*!sc*/
pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0;}/*!sc*/
code{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;white-space:nowrap;border-radius:4px;white-space:pre-wrap;}/*!sc*/
::selection{background-color:#FE7A00;color:#fff;}/*!sc*/
.lg-container .lg-backdrop.in{opacity:0.75;}/*!sc*/
.lg-container .lg-toolbar.lg-group,.lg-container .lg-outer .lg-thumb-outer{background:rgba(0,0,0,0.45);}/*!sc*/
data-styled.g18[id="sc-global-exMkeD1"]{content:"sc-global-exMkeD1,"}/*!sc*/
.cXdfZy{font-size:62px;line-height:1.04;font-weight:700;color:#fff;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.cXdfZy{font-size:50px;}}/*!sc*/
@media (max-width:720px){.cXdfZy{font-size:42px;}}/*!sc*/
data-styled.g19[id="sc-4d34df46-0"]{content:"cXdfZy,"}/*!sc*/
.htQmXI h1{font-size:44px;line-height:1.13;font-weight:700;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h1{font-size:38px;}}/*!sc*/
@media (max-width:720px){.htQmXI h1{font-size:32px;}}/*!sc*/
.htQmXI h2{font-size:33px;line-height:1.13;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h2{font-size:30px;}}/*!sc*/
@media (max-width:720px){.htQmXI h2{font-size:26px;}}/*!sc*/
.htQmXI h3{font-size:28px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.htQmXI h3{font-size:26px;}}/*!sc*/
@media (max-width:720px){.htQmXI h3{font-size:24px;}}/*!sc*/
.htQmXI h4{font-size:22px;line-height:1.18;font-weight:600;color:#1F1F1F;}/*!sc*/
@media (max-width:720px){.htQmXI h4{font-size:20px;}}/*!sc*/
.htQmXI p{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI p{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI p{font-size:18px;}}/*!sc*/
.htQmXI ul,.htQmXI ol{padding-left:40px;}/*!sc*/
.htQmXI ul li,.htQmXI ol li{font-size:22px;line-height:1.36;color:#1F1F1F;}/*!sc*/
@media (max-width:1130px){.htQmXI ul li,.htQmXI ol li{font-size:20px;}}/*!sc*/
@media (max-width:920px){.htQmXI ul li,.htQmXI ol li{font-size:18px;}}/*!sc*/
.htQmXI ul li + li,.htQmXI ol li + li{margin-top:4px;}/*!sc*/
.htQmXI ul{list-style:disc;}/*!sc*/
.htQmXI ol{list-style:decimal;}/*!sc*/
.htQmXI p a,.htQmXI li a{color:#FE7A00;}/*!sc*/
.htQmXI p a:hover,.htQmXI li a:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.htQmXI * + *:not(li,a){margin-top:15px;}/*!sc*/
.htQmXI * + a[data-gallery],.htQmXI * + video{margin-top:40px;}/*!sc*/
.htQmXI a[data-gallery]{display:block;margin-bottom:40px;}/*!sc*/
.htQmXI iframe,.htQmXI video{margin-bottom:40px;}/*!sc*/
data-styled.g22[id="sc-b0f3732d-0"]{content:"htQmXI,"}/*!sc*/
.fdCCNC{display:block;margin-left:auto;margin-right:auto;}/*!sc*/
data-styled.g23[id="sc-b0f3732d-1"]{content:"fdCCNC,"}/*!sc*/
.jiUdjB{padding:80px 0;}/*!sc*/
@media (max-width:920px){.jiUdjB{padding:60px 0;}}/*!sc*/
@media (max-width:720px){.jiUdjB{padding:40px 0;}}/*!sc*/
data-styled.g25[id="sc-18ad0c3-0"]{content:"jiUdjB,"}/*!sc*/
.farhVs{margin-bottom:30px;}/*!sc*/
data-styled.g26[id="sc-18ad0c3-1"]{content:"farhVs,"}/*!sc*/
.evzqvZ{position:relative;}/*!sc*/
data-styled.g27[id="sc-18ad0c3-2"]{content:"evzqvZ,"}/*!sc*/
.kwRhph{position:absolute;top:0;right:100%;width:200px;margin-right:50px;text-align:right;}/*!sc*/
@media (max-width:1130px){.kwRhph{position:unset;width:auto;text-align:left;margin:0 0 30px 0;}}/*!sc*/
data-styled.g28[id="sc-18ad0c3-3"]{content:"kwRhph,"}/*!sc*/
.jMsRbj{font-size:20px;line-height:1.25;color:#1F1F1F;text-transform:capitalize;color:#5651EC;}/*!sc*/
@media (max-width:920px){.jMsRbj{font-size:18px;}}/*!sc*/
.cwWTdU{font-size:20px;line-height:1.25;color:#1F1F1F;}/*!sc*/
@media (max-width:920px){.cwWTdU{font-size:18px;}}/*!sc*/
data-styled.g29[id="sc-18ad0c3-4"]{content:"jMsRbj,cwWTdU,"}/*!sc*/
</style></head><body><div id="__next"><div class="__className_ac89ad"><nav class="sc-6852f5f6-0 gPgccM"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-6852f5f6-1 jrLPNu"><a href="/"><img alt="Orange Logo" loading="lazy" width="120" height="35" decoding="async" data-nimg="1" class="img-logo" style="color:transparent" src="/_next/static/media/logo-orange.faff1861.svg"/></a><div><button aria-label="Toggle navigation" class="sc-46d6b9d9-0 eWdALT"><div></div><div></div><div></div></button><div class="sc-6852f5f6-2 hzGhxs"><ul class="sc-6852f5f6-3 chSgxF"><li><a href="/examples">Examples</a></li><li><a href="/download">Download</a></li><li><a href="/blog">Blog</a></li><li><a href="/docs">Docs</a></li><li><a href="/workshops">Workshops</a></li></ul><form class="sc-6852f5f6-4 hTbjmy"><div class="sc-6852f5f6-5 kzOElI">Search</div><button class="sc-6852f5f6-6 dSfmcG"><img alt="Icon for search" loading="lazy" width="18" height="17" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/icon-search.459b2665.svg"/><span class="sc-cdea7863-0 jTcDmc">Search through page</span></button></form></div></div></div></div></nav><main><div class="sc-18ad0c3-0 jiUdjB"><div class="sc-ef15f394-0 fJLXpS"><div class="sc-18ad0c3-1 farhVs"><p class="sc-18ad0c3-4 jMsRbj"><strong>orange, image analytics, images, machine learning</strong></p><h1 class="sc-4d34df46-0 cXdfZy">Editing the photographs collection with the help of machine learning</h1></div><div class="sc-18ad0c3-2 evzqvZ"><div class="sc-18ad0c3-3 kwRhph"><p class="sc-18ad0c3-4 cwWTdU"><strong>Primož Godec</strong></p><p class="sc-18ad0c3-4 cwWTdU">Feb 11, 2022</p></div><div class="sc-b0f3732d-0 htQmXI"><div class="lg-react-element "><p>The core element of Orange&#x27;s image analysis is embedding images in the vector space. Last year, we upgraded the embedding server infrastructure, enabling around ten times faster image embedding.</p>
<p>We switched from an old cluster with a fixed number of workers for each embedding to a new infrastructure where workers turn on when needed. It means that when a user sends images to the embedder, it will turn on as many instances as required until processors&#x27; cores are available. Inception-v3, VGG16, and VGG19 embedders also perform computation on GPU, making them even faster.</p>
<p>We also made some modifications in the implementation on Orange&#x27;s part, making embedding more reliable.</p>
<h3>How does embedding work?</h3>
<p><a href="/widget-catalog/image-analytics/imageembedding/">The Image Embedding widget</a> gets the table with images&#x27; metadata such as an image name, location and size, but they are not ready for analysis. Images are sent to the server to be embedded in a format understandable to machine learning algorithms. The server pushes images through a pre-trained deep neural network and returns the number vectors to the widget.</p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding-widget.webp" data-gallery="true"><img alt="" loading="lazy" width="674" height="552" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding-widget.webp"/></a>
<p>Deep neural networks are trained on various specific tasks. <a href="https://arxiv.org/abs/1512.00567">Inception v3</a>, <a href="https://arxiv.org/abs/1409.1556">VGG16, VGG19</a> and <a href="https://arxiv.org/abs/1602.07360">SqueezeNet</a> are trained to classify images into 1000 classes according to the object at the image. <a href="https://www.nature.com/articles/s41467-019-12397-x">Painters</a> are trained to predict paintings&#x27; authors, <a href="https://pubmed.ncbi.nlm.nih.gov/29036616/">DeepLoc</a> to predict yeast&#x27;s cells structures and <a href="https://ieeexplore.ieee.org/document/8373812">OpenFace</a> for face recognition. We disregard the classification layer of the network and consider the penultimate layer instead and use that for the image&#x27;s vector-based representation.</p>
<h3>Editing photo collection</h3>
<p>I have taken many photographs in the last few years, but I have not had the time to edit the collection. I want to sort them into subfolders based on the categories. Can machine learning algorithms and image embeddings help me with that?</p>
<p>This blog post will show two approaches for identifying categories and sorting images. The first one is unsupervised, and the second one is supervised.</p>
<p>First, we load photos. We load a folder of images with a collection that we would like to sort in the subfolders (<a href="https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/test-photos.zip">download dataset</a>).</p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-inspect-images.webp" data-gallery="true"><img alt="" loading="lazy" width="700" height="646" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-inspect-images.webp"/></a>
<p>Both approaches will include embedding images. We connect the <a href="/widget-catalog/image-analytics/imageembedding/">Image Embedding</a> widget to the Import Images widget to embed pictures and select <strong>Inception v3 embedder</strong>.</p>
<p><em>Our server deletes all images immediately after embedding. If you would not like to share your photos with our server anyway, you can select the SqueezeNet embedder that embeds images at your computer.</em></p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding.webp" data-gallery="true"><img alt="" loading="lazy" width="700" height="537" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding.webp"/></a>
<p>The Image Embedding widget added 2048 columns with numbers to each image in the data table. Those numbers describe properties that neural networks inferred from pictures. Numbers are not understandable to humans but make sense to machine learning algorithms.</p>
<h3>Image grid will place similar photographs closer on the grid</h3>
<p><a href="/widget-catalog/image-analytics/imagegrid/">The Image Grid</a> uses <a href="/widget-catalog/unsupervised/tsne/">t-sne embedding</a> to project images on 2-dimensional plane based on their image embeddings. More similar images will be closer in the plot.</p>
<p>We passed embedded images from the Image Embedding to the Image Grid widget.</p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-grid.webp" data-gallery="true"><img alt="" loading="lazy" width="700" height="882" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-grid.webp"/></a>
<p>Image Grid has placed similar images closer in the grid. For example, in the top right corner are images of food, in the top left corner are photos of cities, on the right side are pictures of mountains, and at the bottom left are images of sunsets. The Image Grid had more difficulties with snowy photos. Some are placed at the bottom (they seem to include some mountain image elements), and three central ones seem to have elements of cities, mountains and snow.</p>
<p>Since images that belong to the same group are close together, it is easy to mark groups of images manually (colours around images). Marked groups are in the output table as class attributes. We can save them on the computer such that each group is a separate folder with <a href="/widget-catalog/image-analytics/saveimages">the Save Images widget</a>.</p>
<p><strong>Related:</strong> <a href="/blog/2017/04/03/image-analytics-clustering/" target="_blank" rel="noreferrer">Image Analytics: Clustering</a></p>
<h3>Training the model to sort images</h3>
<p>The Image Grid is excellent to discover similar images. Still, it is not practical to sort photos into category groups. If we would like to do that more often, we would always need to assign images to groups manually. Can we have a pipeline that would allow us to make a model that we can reuse later when we take new photos s?</p>
<p><strong>Related</strong>: <a href="https://www.youtube.com/watch?v=lvgx62a8XQk&amp;list=PLmNPvQr9Tf-aRstY69vGAPO_c5RaceBhN&amp;index=1&amp;ab_channel=OrangeDataMining" target="_blank" rel="noreferrer">Video on image classification</a></p>
<p>We can train a classification model that will mark images with categories.</p>
<p>We prepared a separate training dataset with pictures in 5 subfolders. Folders are named: city, food, mountains, sunsets and winter. Names of the folders define categories; once the model is trained, it will always classify images in those categories.</p>
<p>We will first test how accurate the model is.</p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-test-and-score.webp" data-gallery="true"><img alt="" loading="lazy" width="700" height="342" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-test-and-score.webp"/></a>
<p><a href="/widget-catalog/image-analytics/importimages/">The Import Images</a> widget loads images from the training dataset (<a href="https://github.com/PrimozGodec/datasets/raw/master/image-analytics-collection/train-photos.zip">download the training data</a>). Since images are sorted in multiple folders, the widget assigns the folder name to images as a category, which we can see in the Data Table. We embed images with Inception v3 embedder in <a href="/blog/2022-02-edit-image-collection/(/widget-catalog/image-analytics/imageembedding/)">the Image Embedding widget</a> and performs cross-validation in <a href="/widget-catalog/evaluate/testandscore">the Test and Score widget</a>. The model we use is logistic regression. We are happy with the model with AUC 0.992 and classification accuracy of 0.943.</p>
<p>Now we can train the model that will be used to label an unlabeled set of photos.</p>
<a href="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-classification.webp" data-gallery="true"><img alt="" loading="lazy" width="700" height="492" decoding="async" data-nimg="1" class="sc-b0f3732d-1 fdCCNC" style="color:transparent" src="/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-classification.webp"/></a>
<p>We train <a href="/widget-catalog/model/logisticregression">the logistic regression model</a> on the training images in the top branch on the labelled training dataset. Data that we want to label (sort in subfolders) are loaded and embedded in the bottom branch. We use <a href="https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/test-photos.zip">the same images</a> as in the first part of the blog. <a href="/widget-catalog/evaluate/predictions">The Predictions widget</a> assigns labels to the images based on the logistic regression model.</p>
<p>We use <a href="/widget-catalog/image-analytics/imageviewer">the Image Viewer</a> to inspect assigned labels to images. Labels seem to be meaningful and correct. Now that we have photos labelled, we save them to the folder structure with <a href="/widget-catalog/image-analytics/saveimages">the Save Images widget</a> such that each folder is one category. Since the Prediction widget places predictions (column named Logistic Regression) in the meta part of the table, we need to first set the attribute as a target with the Select Columns widget --- the Save Images widget uses the target column as a subfolder name.</p>
<p>We also connected <a href="/widget-catalog/model/savemodel">the Save Model widget</a> to the Logistic Regression. This way, the model is saved for later and can be reused.</p>
<h3>Want to learn more?</h3>
<p>We showed two ways of analysing images with Orange&#x27;s Image Analytics module. The Image Grid is a great tool to identify similar images and see them in the grid. The second one needs an extra effort to prepare a training dataset, but this leads to an automatic pipeline to identify categories.</p>
<p>If you want to learn more about Image Analysis in Orange <a href="https://youtube.com/playlist?list=PLmNPvQr9Tf-aRstY69vGAPO_c5RaceBhN"> watch the tutorial wideos</a> or read related blogs: <a href="/blog/2017/04/03/image-analytics-clustering/%5D">Image Analytics: Clustering</a>, <a href="/blog/2018/05/09/clustering-of-monet-and-manet/">Clustering of Monet and Manet</a>, and <a href="/blog/2017/04/25/outliers-in-traffic-signs/">Outliers in Traffic Signs</a></p></div></div></div></div></div></main><footer class="sc-7afe78da-0 ikuqzB"><div class="sc-ef15f394-0 iSNtvJ"><div class="sc-7afe78da-1 hrSlzr"><div><h3>Orange</h3><ul><li><a href="/faq">FAQ</a></li><li><a href="/license">License</a></li><li><a href="/privacy">Privacy</a></li><li><a href="/citation">Citation</a></li><li><a href="/contact">Contact</a></li></ul></div><div><h3>Download</h3><ul><li><a href="/download#win">Windows</a></li><li><a href="/download#mac">Mac OS</a></li></ul></div><div><h3>Community</h3><ul><li><a href="https://twitter.com/OrangeDataMiner">Twitter</a></li><li><a href="https://www.facebook.com/orangedatamining">Facebook</a></li><li><a href="https://datascience.stackexchange.com/questions/tagged/orange">Stack Exchange</a></li><li><a href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g">YouTube</a></li><li><a href="https://discord.com/invite/FWrfeXV">Discord</a></li></ul></div><div><h3>Documentation</h3><ul><li><a href="/getting-started">Get started</a></li><li><a href="/widget-catalogue">Widgets</a></li><li><a href="https://orange3.readthedocs.io/projects/orange-data-mining-library/en/latest/">Scripting</a></li></ul></div><div><h3>Developers</h3><ul><li><a href="https://github.com/biolab/orange3">GitHub</a></li><li><a href="http://docs.biolab.si/3/development/">Getting started</a></li></ul></div><div><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J" target="_blank" rel="noreferrer" class="sc-e429b959-0 fYoBKL">Donate to Orange</a></div></div><p>Copyright © University of Ljubljana</p></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"author":"Primož Godec","date":"2022-02-11","draft":false,"title":"Editing the photographs collection with the help of machine learning","thumbImage":"2022-02-11-grid-title.jpg","frontPageImage":"2022-02-11-grid-title.jpg","blog":["orange","image analytics","images","machine learning"],"shortExcerpt":"How to use Orange's image embedding to identify similar images, classify them in categories and make an order in your photographs collection?","longExcerpt":"The core element of Orange's image analysis is embedding images in the vector space, which just became a feaster with our infrastructure upgrades. We use this opportunity to show possible ways of analyzing images through observing similar images and classifying them.","x2images":false,"oldUrl":"/blog/2022/2022-02-11-edit-image-collection/"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h3: \"h3\",\n    a: \"a\",\n    strong: \"strong\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {WindowScreenshot, LinkNew} = _components;\n  if (!LinkNew) _missingMdxReference(\"LinkNew\", true);\n  if (!WindowScreenshot) _missingMdxReference(\"WindowScreenshot\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"The core element of Orange's image analysis is embedding images in the vector space. Last year, we upgraded the embedding server infrastructure, enabling around ten times faster image embedding.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We switched from an old cluster with a fixed number of workers for each embedding to a new infrastructure where workers turn on when needed. It means that when a user sends images to the embedder, it will turn on as many instances as required until processors' cores are available. Inception-v3, VGG16, and VGG19 embedders also perform computation on GPU, making them even faster.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We also made some modifications in the implementation on Orange's part, making embedding more reliable.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"How does embedding work?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/imageembedding/\",\n        children: \"The Image Embedding widget\"\n      }), \" gets the table with images' metadata such as an image name, location and size, but they are not ready for analysis. Images are sent to the server to be embedded in a format understandable to machine learning algorithms. The server pushes images through a pre-trained deep neural network and returns the number vectors to the widget.\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-image-embedding-widget.jpg\",\n      width: \"674\",\n      height: \"552\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding-widget.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Deep neural networks are trained on various specific tasks. \", _jsx(_components.a, {\n        href: \"https://arxiv.org/abs/1512.00567\",\n        children: \"Inception v3\"\n      }), \", \", _jsx(_components.a, {\n        href: \"https://arxiv.org/abs/1409.1556\",\n        children: \"VGG16, VGG19\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"https://arxiv.org/abs/1602.07360\",\n        children: \"SqueezeNet\"\n      }), \" are trained to classify images into 1000 classes according to the object at the image. \", _jsx(_components.a, {\n        href: \"https://www.nature.com/articles/s41467-019-12397-x\",\n        children: \"Painters\"\n      }), \" are trained to predict paintings' authors, \", _jsx(_components.a, {\n        href: \"https://pubmed.ncbi.nlm.nih.gov/29036616/\",\n        children: \"DeepLoc\"\n      }), \" to predict yeast's cells structures and \", _jsx(_components.a, {\n        href: \"https://ieeexplore.ieee.org/document/8373812\",\n        children: \"OpenFace\"\n      }), \" for face recognition. We disregard the classification layer of the network and consider the penultimate layer instead and use that for the image's vector-based representation.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Editing photo collection\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I have taken many photographs in the last few years, but I have not had the time to edit the collection. I want to sort them into subfolders based on the categories. Can machine learning algorithms and image embeddings help me with that?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This blog post will show two approaches for identifying categories and sorting images. The first one is unsupervised, and the second one is supervised.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"First, we load photos. We load a folder of images with a collection that we would like to sort in the subfolders (\", _jsx(_components.a, {\n        href: \"https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/test-photos.zip\",\n        children: \"download dataset\"\n      }), \").\"]\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-inspect-images.jpg\",\n      width: \"700\",\n      height: \"646\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-inspect-images.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Both approaches will include embedding images. We connect the \", _jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/imageembedding/\",\n        children: \"Image Embedding\"\n      }), \" widget to the Import Images widget to embed pictures and select \", _jsx(_components.strong, {\n        children: \"Inception v3 embedder\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.em, {\n        children: \"Our server deletes all images immediately after embedding. If you would not like to share your photos with our server anyway, you can select the SqueezeNet embedder that embeds images at your computer.\"\n      })\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-image-embedding.jpg\",\n      width: \"700\",\n      height: \"537\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-embedding.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Image Embedding widget added 2048 columns with numbers to each image in the data table. Those numbers describe properties that neural networks inferred from pictures. Numbers are not understandable to humans but make sense to machine learning algorithms.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Image grid will place similar photographs closer on the grid\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/imagegrid/\",\n        children: \"The Image Grid\"\n      }), \" uses \", _jsx(_components.a, {\n        href: \"/widget-catalog/unsupervised/tsne/\",\n        children: \"t-sne embedding\"\n      }), \" to project images on 2-dimensional plane based on their image embeddings. More similar images will be closer in the plot.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We passed embedded images from the Image Embedding to the Image Grid widget.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-image-grid.jpg\",\n      width: \"700\",\n      height: \"882\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-grid.webp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Image Grid has placed similar images closer in the grid. For example, in the top right corner are images of food, in the top left corner are photos of cities, on the right side are pictures of mountains, and at the bottom left are images of sunsets. The Image Grid had more difficulties with snowy photos. Some are placed at the bottom (they seem to include some mountain image elements), and three central ones seem to have elements of cities, mountains and snow.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Since images that belong to the same group are close together, it is easy to mark groups of images manually (colours around images). Marked groups are in the output table as class attributes. We can save them on the computer such that each group is a separate folder with \", _jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/saveimages\",\n        children: \"the Save Images widget\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Related:\"\n      }), \" \", _jsx(LinkNew, {\n        url: \"/blog/2017/04/03/image-analytics-clustering/\",\n        name: \"Image Analytics: Clustering\"\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Training the model to sort images\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Image Grid is excellent to discover similar images. Still, it is not practical to sort photos into category groups. If we would like to do that more often, we would always need to assign images to groups manually. Can we have a pipeline that would allow us to make a model that we can reuse later when we take new photos s?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Related\"\n      }), \": \", _jsx(LinkNew, {\n        url: \"https://www.youtube.com/watch?v=lvgx62a8XQk\u0026list=PLmNPvQr9Tf-aRstY69vGAPO_c5RaceBhN\u0026index=1\u0026ab_channel=OrangeDataMining\",\n        name: \"Video on image classification\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can train a classification model that will mark images with categories.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We prepared a separate training dataset with pictures in 5 subfolders. Folders are named: city, food, mountains, sunsets and winter. Names of the folders define categories; once the model is trained, it will always classify images in those categories.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We will first test how accurate the model is.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-test-and-score.jpg\",\n      width: \"700\",\n      height: \"342\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-test-and-score.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/importimages/\",\n        children: \"The Import Images\"\n      }), \" widget loads images from the training dataset (\", _jsx(_components.a, {\n        href: \"https://github.com/PrimozGodec/datasets/raw/master/image-analytics-collection/train-photos.zip\",\n        children: \"download the training data\"\n      }), \"). Since images are sorted in multiple folders, the widget assigns the folder name to images as a category, which we can see in the Data Table. We embed images with Inception v3 embedder in \", _jsx(_components.a, {\n        href: \"/blog/2022-02-edit-image-collection/(/widget-catalog/image-analytics/imageembedding/)\",\n        children: \"the Image Embedding widget\"\n      }), \" and performs cross-validation in \", _jsx(_components.a, {\n        href: \"/widget-catalog/evaluate/testandscore\",\n        children: \"the Test and Score widget\"\n      }), \". The model we use is logistic regression. We are happy with the model with AUC 0.992 and classification accuracy of 0.943.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now we can train the model that will be used to label an unlabeled set of photos.\"\n    }), \"\\n\", _jsx(WindowScreenshot, {\n      src: \"/blog/2022-02-edit-image-collection/2022-02-11-image-classification.jpg\",\n      width: \"700\",\n      height: \"492\",\n      src: \"/blog/2022-02-edit-image-collection/__webp-images__/2022-02-11-image-classification.webp\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We train \", _jsx(_components.a, {\n        href: \"/widget-catalog/model/logisticregression\",\n        children: \"the logistic regression model\"\n      }), \" on the training images in the top branch on the labelled training dataset. Data that we want to label (sort in subfolders) are loaded and embedded in the bottom branch. We use \", _jsx(_components.a, {\n        href: \"https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/test-photos.zip\",\n        children: \"the same images\"\n      }), \" as in the first part of the blog. \", _jsx(_components.a, {\n        href: \"/widget-catalog/evaluate/predictions\",\n        children: \"The Predictions widget\"\n      }), \" assigns labels to the images based on the logistic regression model.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We use \", _jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/imageviewer\",\n        children: \"the Image Viewer\"\n      }), \" to inspect assigned labels to images. Labels seem to be meaningful and correct. Now that we have photos labelled, we save them to the folder structure with \", _jsx(_components.a, {\n        href: \"/widget-catalog/image-analytics/saveimages\",\n        children: \"the Save Images widget\"\n      }), \" such that each folder is one category. Since the Prediction widget places predictions (column named Logistic Regression) in the meta part of the table, we need to first set the attribute as a target with the Select Columns widget --- the Save Images widget uses the target column as a subfolder name.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We also connected \", _jsx(_components.a, {\n        href: \"/widget-catalog/model/savemodel\",\n        children: \"the Save Model widget\"\n      }), \" to the Logistic Regression. This way, the model is saved for later and can be reused.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Want to learn more?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We showed two ways of analysing images with Orange's Image Analytics module. The Image Grid is a great tool to identify similar images and see them in the grid. The second one needs an extra effort to prepare a training dataset, but this leads to an automatic pipeline to identify categories.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you want to learn more about Image Analysis in Orange \", _jsx(_components.a, {\n        href: \"https://youtube.com/playlist?list=PLmNPvQr9Tf-aRstY69vGAPO_c5RaceBhN\",\n        children: \" watch the tutorial wideos\"\n      }), \" or read related blogs: \", _jsx(_components.a, {\n        href: \"/blog/2017/04/03/image-analytics-clustering/%5D\",\n        children: \"Image Analytics: Clustering\"\n      }), \", \", _jsx(_components.a, {\n        href: \"/blog/2018/05/09/clustering-of-monet-and-manet/\",\n        children: \"Clustering of Monet and Manet\"\n      }), \", and \", _jsx(_components.a, {\n        href: \"/blog/2017/04/25/outliers-in-traffic-signs/\",\n        children: \"Outliers in Traffic Signs\"\n      })]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"editing-the-photographs-collection-with-the-help-of-machine-learning"},"buildId":"lhloBTgr-gRDgL8UrpHOm","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>